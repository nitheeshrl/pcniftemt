<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Students Details</title>
  <link rel="stylesheet" href="style 3.css">
  <link rel="icon" href="white_logo.png" type="image/x-icon">
  <script type="text/javascript" src="app.js" defer></script>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" href="style 1.css" />
  <link rel="stylesheet" type="text/css" href="style 2.css">
  <link rel="manifest" href="manifest.json">
  <script src="script-notification.js"></script>

 <style>
    table .approve{
       border-radius: 20px;
       padding: 10px;
       color: white;
       font-weight: bolder;
background-color: green;
margin-right: 20px;
text-decoration: none;
cursor: pointer;
}
table .decline{
border-radius: 20px;
padding: 10px;
color: white;
font-weight: bolder;
background-color: red;
margin-right: 20px;
text-decoration: none;
cursor: pointer;
}
.tablebee{
  width: 99%;
display: nonge;
}
.btn{
background-color:#182d8b;
margin-right: 20px;
text-decoration: none;
color: white;
border-radius: 20px;
padding: 20px;
cursor: pointer;
}
.btn1{
background-color:#182d8b;
height: 40px;
text-decoration: none;
color: white;
border-radius: 20px;
padding:12px;
cursor: pointer;
font-weight: bold;
}
.tablebee{
  height: 100%;
  overflow: scroll;
}

</style>
<script>
  function logout(){
    updatelogstatus("Offline");  
    localStorage.removeItem("loggedname")
    window.location="../logout.html";
  }
  function userPopup(){
        console.log("ok")
document.getElementById("popup-4").classList.toggle("active");
}
function logoutPopup(){
        console.log("ok")
document.getElementById("popup-3").classList.toggle("active");

}
function editPopup(edit){
  console.log(edit)
  console.log(vdatas)
  var udata = vdatas[edit-2];
  console.log(udata)
var inputs = document.getElementById("popup-inner").querySelectorAll("div");
console.log(inputs)
var now = 0;
inputs.forEach((i,jk) =>{
  console.log(i.children,udata[now])
  if(jk==0){
    if (udata[now].includes("google.com")){
    udata[now] = "https://google.com"+udata[now];
  }
  else{
    udata[now] = "https://spcniftemt.pages.dev/user/"+udata[now];
  }
    i.children[0].children[0].src = udata[now];
  }
  else{
    i.children[1].value = udata[now];
  }
//  i.children[1].value = udata[now];
  now++
})


var allotoption = "";
console.log(umembers)
var allotnamee="";
umembers.forEach((h,inf) =>{
 
  if (h[0]==udata[5]){
    var option = `<option value="`+umembersids[inf][0]+`" selected>`+h[0]+`</option>`;
  }
  else{
    var option = `<option value="`+umembersids[inf][0]+`">`+h[0]+`</option>`;
  }
  allotoption += option;
})

console.log(udata[5])
console.log(allotnamee)
inputs[5].children[1].selectedIndex = allotnamee;
console.log(inputs[5].children[1].selectedIndex)
document.getElementById("Alloted Member").innerHTML =  allotoption;
if (udata[3].includes("M.Tech")){
    document.getElementById("popup-inner").querySelectorAll("div")[6].style.display="none"
      document.getElementById("popup-inner").querySelectorAll("div")[8].style.display="none"
}
else{
  console.log(vrole)
  if(vrole=="Admin"){
      document.getElementById("popup-inner").querySelectorAll("div")[6].style.display="flex"
  }
  else{
    document.getElementById("popup-inner").querySelectorAll("div")[6].style.display="none" 
  }
      document.getElementById("popup-inner").querySelectorAll("div")[8].style.display="flex"
}
document.getElementById("popup-1").classList.toggle("active");
console.log(document.getElementById("popup-inner").querySelectorAll("div")[inputs.length-1].children[1])
document.getElementById("popup-inner").querySelectorAll("div")[inputs.length-1].children[1].setAttribute("onclick","updatedetails("+edit+")")
}
function addPopup(){
var allotoption = "";
console.log(umembers)
umembers.forEach((h,inf) =>{
  var option = `<option value="`+umembersids[inf][0]+`">`+h[0]+`</option>`;
  allotoption += option;
})
document.getElementById("popup-inner-add").querySelectorAll("div")[5].children[1].innerHTML = `<option value="">Select the Alloted Member</option>` + allotoption;
document.getElementById("popup-40").classList.toggle("active");
}
</script>
</head>
<body>
  <div class="internetstatus-box" id="internetstatus-box">
    <div class="internetstatus" id="internetstatus">
      <span>You are Online</span>
    </div>
  </div>
  <script src="common.js"></script>
  <nav id="sidebar">
    <ul>
      <li class="indetails" id="insname">
        <div style="width: 50px; display: flex;gap: 10px;">
          <img style="width: 50px;" src="white_logo.png" alt="">
          <span style="color: white;">NIFTEM-T <br> Placement Cell</span>
        </div>
        
        <button onclick=toggleSidebar() id="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z"/></svg>
        </button>
      </li>
      <li class="outdetails" id="outlogo" style="">
        <button class="out-items" onclick=toggleSidebar1() id="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z"/></svg>
        </button>
        <img class="out-items" style="width: 50px;" src="white_logo.png" alt="">
        <img id="profileimage1" style=" scale:90%;border-radius: 50px; width: 50px; height: 50px; " src=".//1.png" alt="" srcset="">
       
      </li>
      <li class="indetails"  id="insprofile" style="left: 0px;">
        <div class="log-items" style="flex-direction: column; gap: 0px; align-items: center;justify-content: center;">
         <a onclick="userPopup()"><img id="profileimage" style=" scale:200%;border-radius: 50px; width: 50px; height: 50px; " src=".//1.png" alt="" srcset=""></a>
       <div style="background-color: white; color: black; padding: 10px;border-radius: 40px;">
        <p ><span id="mname">Nitheesh R L</span></p>
       </div>
       

          </div>

      </li>
      <li>
        <a href="dash.html">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M520-640v-160q0-17 11.5-28.5T560-840h240q17 0 28.5 11.5T840-800v160q0 17-11.5 28.5T800-600H560q-17 0-28.5-11.5T520-640ZM120-480v-320q0-17 11.5-28.5T160-840h240q17 0 28.5 11.5T440-800v320q0 17-11.5 28.5T400-440H160q-17 0-28.5-11.5T120-480Zm400 320v-320q0-17 11.5-28.5T560-520h240q17 0 28.5 11.5T840-480v320q0 17-11.5 28.5T800-120H560q-17 0-28.5-11.5T520-160Zm-400 0v-160q0-17 11.5-28.5T160-360h240q17 0 28.5 11.5T440-320v160q0 17-11.5 28.5T400-120H160q-17 0-28.5-11.5T120-160Zm80-360h160v-240H200v240Zm400 320h160v-240H600v240Zm0-480h160v-80H600v80ZM200-200h160v-80H200v80Zm160-320Zm240-160Zm0 240ZM360-280Z"/></svg>
          <span>Dashboard</span>
        </a>
      </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h207q16 0 30.5 6t25.5 17l57 57h320q33 0 56.5 23.5T880-640v400q0 33-23.5 56.5T800-160H160Zm0-80h640v-400H447l-80-80H160v480Zm0 0v-480 480Zm400-160v40q0 17 11.5 28.5T600-320q17 0 28.5-11.5T640-360v-40h40q17 0 28.5-11.5T720-440q0-17-11.5-28.5T680-480h-40v-40q0-17-11.5-28.5T600-560q-17 0-28.5 11.5T560-520v40h-40q-17 0-28.5 11.5T480-440q0 17 11.5 28.5T520-400h40Z"/></svg>
          <span>Brochure Update</span>
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu">
          <div>
            <li><a href="index.html">Active Requests</a></li>
            <li><a href="past.html">Past Requests</a></li>
            <li><a  target="_blank" href="https://niftemt-placementcell-forms.pages.dev/B2K21%20Brochure%20Details%20Update/user">Request Form</a></li>
          </div>
        </ul>
      </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m221-313 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-228q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm0-320 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-548q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm339 353q-17 0-28.5-11.5T520-320q0-17 11.5-28.5T560-360h280q17 0 28.5 11.5T880-320q0 17-11.5 28.5T840-280H560Zm0-320q-17 0-28.5-11.5T520-640q0-17 11.5-28.5T560-680h280q17 0 28.5 11.5T880-640q0 17-11.5 28.5T840-600H560Z"/></svg>
          <span>Forms</span>
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu">
          <div>
            <li><a href="new-placement-form.html">New Placement Form</a></li>
            <li><a  href="past-placement-forms.html">Old Placement Forms</a></li>
            <li><a href="new-form.html">New Form</a></li>
            <li><a  href="past-forms.html">Old Forms</a></li>
          </div>
        </ul>
      </li>
      <li class="active">
          <a href="all-users.html">
            <svg viewBox="0 0 24 24" height="24px" xmlns="http://www.w3.org/2000/svg" > <path fill-rule="evenodd" clip-rule="evenodd" d="M9.29289 1.29289C9.48043 1.10536 9.73478 1 10 1H18C19.6569 1 21 2.34315 21 4V8C21 8.55228 20.5523 9 20 9C19.4477 9 19 8.55228 19 8V4C19 3.44772 18.5523 3 18 3H11V8C11 8.55228 10.5523 9 10 9H5V20C5 20.5523 5.44772 21 6 21H9C9.55228 21 10 21.4477 10 22C10 22.5523 9.55228 23 9 23H6C4.34315 23 3 21.6569 3 20V8C3 7.73478 3.10536 7.48043 3.29289 7.29289L9.29289 1.29289ZM6.41421 7H9V4.41421L6.41421 7ZM18 19C15.2951 19 14 20.6758 14 22C14 22.5523 13.5523 23 13 23C12.4477 23 12 22.5523 12 22C12 20.1742 13.1429 18.5122 14.9952 17.6404C14.3757 16.936 14 16.0119 14 15C14 12.7909 15.7909 11 18 11C20.2091 11 22 12.7909 22 15C22 16.0119 21.6243 16.936 21.0048 17.6404C22.8571 18.5122 24 20.1742 24 22C24 22.5523 23.5523 23 23 23C22.4477 23 22 22.5523 22 22C22 20.6758 20.7049 19 18 19ZM18 17C19.1046 17 20 16.1046 20 15C20 13.8954 19.1046 13 18 13C16.8954 13 16 13.8954 16 15C16 16.1046 16.8954 17 18 17Z" ></path> </svg>
            <span>Students Details</span>
          </a>
        </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-240v-32q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v32q0 33-23.5 56.5T720-160H240q-33 0-56.5-23.5T160-240Zm80 0h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z"/></svg>
          <span>Profile</span>
 
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu">
          <div>
            <li><a href="change-pass-1.html">Change Password</a></li>
            <li><a onclick="passkey()">Create PassKey</a></li>
            <li><a onclick="logoutPopup()" >Logout</a></li>
          </div>
        </ul>
      </li>

    </ul>
  </nav>
  <main style="overflow: hidden;">
    <div class="container" onclick="closeAllSubMenus()">
      <main style="margin-top: 30px;" class="table" id="customers_table">
        <section class="table__header">

            <div class="input-group">
                <input  type="search" placeholder="Search..." >
                <img src="images/search.png" alt="">
            </div>
<div style="width: auto;padding: 10px;">
  <button onclick="addPopup()" class="btn">Add Student</button>
 
</div>
        </section>

       <section id="tablebee" class="tablebee">         
        <section  class="table__body" >

          
 <table  id="tabdetails">
               </table>
          
        </section>
    </section> 

    <section class="msg" >

        <h1 style="text-align: center;"></h1>
        <div   id="dfiled" style="align-content:normal; margin-left: 0px;margin-right: auto; margin-top: 30px;"><p style="text-align: left;">
            <div ></div> <span id = "status" style="color: black;"></span></p></div>
            </p>
            </section>
            <section style="height: 100px; display: flex;justify-content: center;">
      
            </section>
    </main>
    <div id="load" class="load" > 
        <div class="loader" id="loader"> 
      
          </div> 
          <div
            id="message"
          class="message"
          style="width: 350px;"
            ></div>
        </div>      
        <div class="popup1" id="popup-3">
 
          <div class="overlay"></div>
      
          <div class="content">
      
          <div class="close-btn" onclick="togglePopup3()">&times;</div>
      
          <h1 style="margin-top: 50px;">Are you sure to logout?</h1>
      
          <p style="margin-bottom: 40px;"> </p>
          <div >
              <input id="aid" type="hidden" value="">
      <a class="btn" id="apbt" onclick="logout()">Yes</a>
      <a class="btn" onclick="togglePopup3()">Cancel</a>
          </div>
          </div>
      
          </div>
          <div class="popup" id="popup-1">
 
            <div class="overlay"></div>
        
            <div class="content" style="max-height: 90%; height: auto;">
        
            <div class="close-btn" onclick="togglePopup()">&times;</div>
        <div class="popup-inner" id="popup-inner">
            <h1>Edit User Details</h1>
            <div class="form-element">
              <div style="background-color: rgb(237, 235, 235); border-radius: 110px;height: 110px;width: 110px;margin-top: 0px;margin-left: auto;margin-right: auto;">
                <img  style=" border-radius: 50px; width: 100px; height: 100px; object-fit: cover;" src="`+datas[r][d]+`" alt="" srcset="">
              </div>
            <div class="form-element">
              <span class="q">Name</span>
              <input type="text" name="Name" id="Name"  placeholder="Enter your Name" />
              </div>
              
              <div class="form-element">
              <span class="q">ID Number</span>
              <input readonly type="text" name="ID Number" id="ID Number"  placeholder="Enter your ID Number" />
              </div>
              
              <div class="form-element">
              <span class="q">Email ID</span>
              <input type="text" name="Email ID" id="Email ID"  placeholder="Enter your Email ID" />
              </div>
              
              <div class="form-element">
              <span class="q">Degree</span>
              <input type="text" name="Degree" id="Degree"  placeholder="Enter your Degree" />
              </div>
              
              <div class="form-element">
              <span class="q">Batch</span>
              <input type="text" name="Batch" id="Batch"  placeholder="Enter your Batch" />
              </div>
              
              <div class="form-element">
              <span class="q">Alloted Member</span>
              <select name="Alloted Member" id="Alloted Member" >
              </select>
              </div>
              
              <div class="form-element">
              <span class="q">Internship Preference</span>
              <select name="Internship Preference" id="Internship Preference" >
                <option value="Internship through Institute ">Internship through Institute </option>
                <option value="Internship by own">Internship by own</option>
              </select>
              </div>
              
             <div class="form-element">
              <span class="q">Internship Consideration</span>
              <select name="Internship Consideration" id="Internship Consideration" >
                <option value="Yes">Yes</option>
                <option value="No">No</option>
              </select>
            </div>
              
              <div class="form-element">
              <span class="q">Internship Company</span>
              <input type="text" name="Internship Company" id="Internship Company"  placeholder="Enter your Internship Company" />
              </div>
              
              <div class="form-element">
              <span class="q">Placement Preference</span>
          
              <select name="Placement Preference" id="Placement Preference" >
                <option value="Entrepreneurship">Entrepreneurship</option>
                <option value="Higher Studies">Higher Studies</option>
                <option value="Placement">Placement</option>
              </select>
              </div>
              
              <div class="form-element">
              <span class="q">Placement Consideration</span>
              <select name="Placement Consideration" id="Placement Consideration" >
                <option value="Yes">Yes</option>
                <option value="No">No</option>
              </select>
              </div>
              
              <div class="form-element">
              <span class="q">1st Placement Company</span>
              <input type="text" name="1st Placement Company" id="1st Placement Company"  placeholder="Enter your 1st Placement Company" />
              </div>
              
              <div class="form-element">
              <span class="q">2nd Placement Company</span>
              <input type="text" name="2nd Placement Company" id="2nd Placement Company"  placeholder="Enter your 2nd Placement Company" />
              </div>
            <div class="popup-btn">
                <input id="aid" type="hidden" value="">
        <a class="btn" id="apbt" onclick="approve()">Update</a>
        <a class="btn" onclick="togglePopup()">Cancel</a>
            </div>
            </div>
          </div>
            </div>
            <div class="popup" id="popup-40">
 
              <div class="overlay"></div>
          
              <div class="content" style="max-height: 90%; height: auto;max-width: 650px;width: 90%;">
          
              <div class="close-btn" onclick="togglePopup40()">&times;</div>
          <div class="popup-inner" id="popup-inner-add"  style="padding: 50px;">
              <h1>Add Student</h1>
              <div class="form-element">
              <div style="background-color: rgb(237, 235, 235); border-radius: 110px;height: 110px;width: 110px;margin-top: 0px;margin-left: auto;margin-right: auto;">
                <img  style=" border-radius: 50px; width: 100px; height: 100px; object-fit: cover;" src="" alt="" srcset="">
              </div>
            </div>              
              <div class="form-element">
                <span class="q">Name</span>
                <input required type="text" name="Name"   placeholder="Enter your Name" />
                </div>
                
                <div class="form-element">
                <span class="q">ID Number</span>
                <input required type="text" name="ID Number"  placeholder="Enter your ID Number" />
                </div>
                
                <div class="form-element">
                <span class="q">Email ID</span>
                <input required type="text" name="Email ID"  placeholder="Enter your Email ID" />
                </div>
                
                <div class="form-element">
                <span class="q">Degree</span>
                <select required name="Degree" >
                  <option value="">Select the Degree</option>
                  <option value="B.Tech - Food Technology ">B.Tech - Food Technology </option>
                  <option value="M.Tech - Food Process Technology">M.Tech - Food Process Technology</option>
                  <option value="M.Tech - Food Process Engineering">M.Tech - Food Process Engineering</option>
                  <option value="M.Tech - Food safety and Quality Assurance">M.Tech - Food safety and Quality Assurance</option>
                </select>
                </div>
                
                <div class="form-element">
                <span class="q">Batch</span>
                <input required type="text" name="Batch"  placeholder="Enter your Batch" />
                </div>
                
                <div class="form-element">
                <span class="q">Alloted Member</span>
                <select required name="Alloted Member" >
                </select>
                </div>
                
                <div class="form-element">
                <span class="q">Internship Preference</span>
                <select required name="Internship Preference" >
                  <option value="">Select the Internship Preference</option>
                  <option value="Internship through Institute ">Internship through Institute </option>
                  <option value="Internship by own">Internship by own</option>
                </select>
                </div>
                
                <div class="form-element">
                <span class="q">Internship Company</span>
                <input type="text" name="Internship Company"placeholder="Enter your Internship Company" />
                </div>
                
                <div class="form-element">
                <span class="q">Placement Preference</span>
            
                <select required name="Placement Preference" >
                  <option value="">Select the Placement Preference</option>
                  <option value="Entrepreneurship">Entrepreneurship</option>
                  <option value="Higher Studies">Higher Studies</option>
                  <option value="Placement">Placement</option>
                </select>
                </div>

                <div class="form-element">
                <span class="q">1st Placement Company</span>
                <input type="text" name="1st Placement Company"  placeholder="Enter your 1st Placement Company" />
                </div>
                
                <div class="form-element">
                <span class="q">2nd Placement Company</span>
                <input type="text" name="2nd Placement Company" placeholder="Enter your 2nd Placement Company" />
                </div>
              <div class="popup-btn">
                  <input id="aid" type="hidden" value="">
          <a class="btn" id="apbt" onclick="addstudent(this)">Add</a>
          <a class="btn" onclick="togglePopup40()">Cancel</a>
              </div>
              </div>
            </div>
              </div>
      <div class="popup" id="popup-2">
  
          <div class="overlay"></div>
      
          <div class="content" style="height:400px;">
      
          <div class="close-btn" onclick="togglePopup2()">&times;</div>
      
          <h1 style="margin-top: 50px;">Confirm Update Decline</h1>
      
          <p style="margin-bottom: 40px;">Are you sure you wish to decline the Brochure details update? </p>
          <div >
              <div class="form-element" style=" flex-direction: column;align-items: flex-start; width: 100%;margin-bottom: 40px;">
                  <span class="q" >Reason for decline</span>
                  <input type="text" name="Reason" id="Reason" style="width: 100%;" placeholder="Enter the reason" />
                  </div>
                  <input id="did" type="hidden" value="">
      <a class="btn" id="decbt" onclick="decline()" style="background-color: red;">Decline</a>
      <a class="btn" onclick="togglePopup2()">Cancel</a>
          </div>
          </div>
      
          </div>
    </div>
   
  </main>
  
</body>
<script src="https://unpkg.com/@simplewebauthn/browser/dist/bundle/index.umd.min.js"></script>
<script src="scriptform.js"></script>
<script src="https://web-socket-1-kmp6.onrender.com/socket.io/socket.io.js"></script>
<script src="socket.js"></script>
<script>
    var porfilepicback = sessionStorage.getItem("backprofilepic");
  if (porfilepicback!==null){
    document.getElementById("profileimage").src = porfilepicback;
    document.getElementById("profileimage1").src = porfilepicback;
  }
    function notavailable(){
    alert("Not Available")
  }
const  GetUniqueID = () =>{
const uniqueID = localStorage.getItem("Passkey-uniqueID");
if (uniqueID == undefined){
const newUniqueID = crypto.randomUUID();

return [newUniqueID, "New"];
}
else {
return uniqueID;
}
}
async function passkey(){
           var passdevuniid =GetUniqueID();
           console.log(passdevuniid);
if (passdevuniid[1] ==  "New"){
 document.getElementById("loader").style.display="block"; 
           document.getElementById("load").style.display="initial";
           document.getElementById("message").textContent="Registering PassKey....";
         
       var passkeysss ={};
var fetchurl = "https://passkey-5ev6.onrender.com";
       const { startRegistration, startAuthentication } = SimpleWebAuthnBrowser;
           const url = new URL(window.location)
           const username = localStorage.getItem("loggedname");
           var weburl = location.hostname;
           console.log(weburl)
           const response = await fetch(fetchurl+'/register-challenge', {
               method: 'POST',
               headers: {
                   'Content-Type': 'application/json'
               },
               body: JSON.stringify({ username, weburl })
           })

           const challengeResult = await response.json()
           const { options } = challengeResult // Server side challenge

           const authenticationResult = await startRegistration({optionsJSON: options})
           console.log(authenticationResult)

           var urlorigin= location.protocol+"//"+location.host;
           console.log(urlorigin)
           var create_passkey = await fetch(fetchurl+'/register-verify', {
               method: 'POST',
               headers: {
                   'Content-Type': 'application/json'
               },
               body: JSON.stringify({ username, cred: authenticationResult, challenge: options.challenge, devUniId:passdevuniid[0], weburl,urlorigin })
           })
           const create_passkeyResult = await create_passkey.json();
           console.log(create_passkeyResult.result)
           
           
passkeysss = create_passkeyResult.info;
console.log(create_passkeyResult.info);
if (create_passkeyResult.info.userVerified){
 localStorage.setItem("Passkey-uniqueID",passdevuniid[0]);
 document.getElementById("loader").style.display="none"; 
document.getElementById("message").textContent="PassKey Registered Successfully";
setTimeout(function () { 
 document.getElementById("load").style.display="none";
},2000);
}


}
else{
alert("PassKey is already created for this Device")
}
}
       function approvePopup(id){
           console.log("ok")
   document.getElementById("popup-1").classList.toggle("active");
   document.getElementById("aid").value = id;
   
   }

   function togglePopup(){
   document.getElementById("popup-1").classList.toggle("active");
   }
   function declinePopup(id){
       console.log("ok")
   document.getElementById("popup-2").classList.toggle("active");
   document.getElementById("did").value = id;
   
   }
   function togglePopup2(){
   document.getElementById("popup-2").classList.toggle("active");
   }
   function togglePopup3(){
   document.getElementById("popup-3").classList.toggle("active");
   }
   function togglePopup4(){
   document.getElementById("popup-4").classList.toggle("active");
   }
   function togglePopup40(){
   document.getElementById("popup-40").classList.toggle("active");
   }
   var uname ;
  
  uname = localStorage.getItem("loggedname");
  console.log(uname)
  console.log(document.getElementById("profileimage").src)
  document.getElementById("mname").innerHTML = uname;
  
  if (uname==undefined){
    alert("You are not logged in. Please log in");
    sessionStorage.setItem("lastpage",window.location.pathname)
    window.location="../index.html";
  }
   document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Students Details Fetching....";
           var allotdiv;
           var vdatas = [];
           var vheads = [];
           var vrole ; 
           var umembers = [];
           var umembersids = [];
           var uongoing="";
           function fetchd (){
  console.log("Students Details Fetching....")
var loggedname = localStorage.getItem("loggedname");
    var formDataString =loggedname;
    console.log(formDataString)

    fetch(
      "https://script.google.com/macros/s/AKfycbxhdNnGyV_dfCe2nAlWj7VzHdyRsuQFW4q_aFYpCh9w2WtaP3i6mWTiJx97MgRH3G4jUw/exec",
      {
        redirect: "follow",
        method: "POST",
        body: formDataString,
        headers: {
          "Content-Type": "text/plain;charset=utf-8",
        },
      }
    )

      .then(function (response) {

        // Check if the request was successful
        if (response) {
     
          return response; // Assuming your script returns JSON response
        } else {
          throw new Error("Failed to fetch");
        }
      })
      .then(async function (data) {
        const result1 = await data.json();
var userdetails = result1.data2;
console.log(userdetails)
vheads = userdetails.heads;
var heads = userdetails.heads;
vdatas = userdetails.datas;
var datas = userdetails.datas;
umembers = userdetails.members;
umembersids = userdetails.membersids;
var allots = userdetails.allots;
var role = userdetails.role;
vrole = userdetails.role;
var access = userdetails.access;
var uaccess = userdetails.uaccess;
var th = "";

/*if (document.getElementById('Alloted Member')!==null){
allotdiv = document.getElementById('Alloted Member').parentElement;
}
console.log(allotdiv)*/
if (role == "User"){
 // heads.splice(5,1);
  document.getElementById("popup-inner").querySelectorAll("div")[1].style.display="none"
  document.getElementById("popup-inner").querySelectorAll("div")[3].style.display="none"
  document.getElementById("popup-inner").querySelectorAll("div")[4].style.display="none"
  document.getElementById("popup-inner").querySelectorAll("div")[5].style.display="none"
  document.getElementById("popup-inner").querySelectorAll("div")[7].style.display="none"
  document.getElementById("popup-inner").querySelectorAll("div")[9].style.display="none"
  document.getElementById("popup-inner").querySelectorAll("div")[10].style.display="none"

/*if(allotdiv!==undefined){
  allotdiv.remove();
}*/
}
else{
  document.getElementById("popup-inner").querySelectorAll("div")[1].style.display="none"
  document.getElementById("popup-inner").querySelectorAll("div")[3].style.display="none"
  document.getElementById("popup-inner").querySelectorAll("div")[4].style.display="none"
  document.getElementById("popup-inner").querySelectorAll("div")[5].style.display="flex"
  document.getElementById("popup-inner").querySelectorAll("div")[7].style.display="none"
  document.getElementById("popup-inner").querySelectorAll("div")[9].style.display="flex"
  document.getElementById("popup-inner").querySelectorAll("div")[10].style.display="none"
//  if (document.getElementById('Alloted Member')==null){
   
 // document.getElementById("popup-inner").querySelectorAll("div")[4].insertAdjacentElement("afterend",allotdiv) 
}
//}
for (var i=0; i<heads.length;i++){
  if (role == "User"&&i==5){
continue;
}
th +="<th>"+heads[i]+"</th>";

}
var thead = "<thead><th>Edit</th>"+th+"</thead>";
var tr ="";
for (var r=0; r<datas.length;r++){
  var td ="";

  if ((access == "No"||(!access.includes(uaccess[r])&&access !== "All"))&&loggedname!==allots[r]){
   // datas.splice(r,1)
   continue;
   console.log(r)
  }
  for (var d=0; d<datas[r].length;d++){
    if (role == "User"&&d==5){
continue;
}
if (d==0){
  if (datas[r][d].includes("google.com")){
    datas[r][d] = "https://google.com"+datas[r][d];
  }
  else{
    datas[r][d] = "https://spcniftemt.pages.dev/user/"+datas[r][d];
  }

 td +="<td>"+ `<div style="background-color: rgb(237, 235, 235); border-radius: 110px;height: 110px;width: 110px;margin-top: 0px;margin-left: auto;margin-right: auto;">
                <img  style=" border-radius: 50px; width: 100px; height: 100px; object-fit: cover;" src="`+datas[r][d]+`" alt="" srcset="">
              </div>`+"</td>";
            //  td +="<td>"+ ` <img  style="object-fit: cover;width: 100px; height: 100px;" src="`+datas[r][d]+`" alt="">`+"</td>";
            
//  td +="<td>"+datas[r][d]+"</td>";

}
else{
td +="<td>"+datas[r][d]+"</td>";
}
}
var editno = Number(r)+2;
tr +="<tr><td>"+`<svg onclick="editPopup(`+editno+`)"  fill="#0042aa" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 494.936 494.936" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M389.844,182.85c-6.743,0-12.21,5.467-12.21,12.21v222.968c0,23.562-19.174,42.735-42.736,42.735H67.157 c-23.562,0-42.736-19.174-42.736-42.735V150.285c0-23.562,19.174-42.735,42.736-42.735h267.741c6.743,0,12.21-5.467,12.21-12.21 s-5.467-12.21-12.21-12.21H67.157C30.126,83.13,0,113.255,0,150.285v267.743c0,37.029,30.126,67.155,67.157,67.155h267.741 c37.03,0,67.156-30.126,67.156-67.155V195.061C402.054,188.318,396.587,182.85,389.844,182.85z"></path> <path d="M483.876,20.791c-14.72-14.72-38.669-14.714-53.377,0L221.352,229.944c-0.28,0.28-3.434,3.559-4.251,5.396l-28.963,65.069 c-2.057,4.619-1.056,10.027,2.521,13.6c2.337,2.336,5.461,3.576,8.639,3.576c1.675,0,3.362-0.346,4.96-1.057l65.07-28.963 c1.83-0.815,5.114-3.97,5.396-4.25L483.876,74.169c7.131-7.131,11.06-16.61,11.06-26.692 C494.936,37.396,491.007,27.915,483.876,20.791z M466.61,56.897L257.457,266.05c-0.035,0.036-0.055,0.078-0.089,0.107 l-33.989,15.131L238.51,247.3c0.03-0.036,0.071-0.055,0.107-0.09L447.765,38.058c5.038-5.039,13.819-5.033,18.846,0.005 c2.518,2.51,3.905,5.855,3.905,9.414C470.516,51.036,469.127,54.38,466.61,56.897z"></path> </g> </g> </g></svg>`+"</td>"+td+"</tr>";
}

var tbody = "<tbody>"+tr+"</tbody>";
var search2 = document.querySelector('.input-group input').value;
if(search2==""){
document.getElementById("tabdetails").innerHTML = thead+tbody;
}
if (uongoing==""){
document.getElementById("load").style.display="none";
           document.getElementById("loader").style.display="none"; 
           document.getElementById("message").textContent = "";
}
fetchd ();
      })

      .catch(function (error) {
        // Handle errors, you can display an error message here
        console.error(error);
        fetchd ();
      });
    
       }
      fetchd ();
   
      /*function updatelogstatus(status){
      var updatestring = localStorage.getItem("loggedname")+"/"+status;
 
           
       fetch(
    
    "https://script.google.com/macros/s/AKfycbxEoNGPxEXxwtSXqRvPhgGK_btTmbVO4Tq6ZW002Q7Olap6cyoi5hmNAwYTS3OfLJCLug/exec",
    {
      redirect: "follow",
      method: "POST",
      body: updatestring,
      headers: {
        "Content-Type": "text/plain;charset=utf-8",
      },
    }
   )
   
    .then(function (response) {
   
      // Check if the request was successful
      if (response) {
   
        return response; // Assuming your script returns JSON response
      } else {
        throw new Error("Failed to fetch.");
      }
    })
    .then(async function (data) {
   const result1 = await data.json();
   
   var r = result1.data2;
  
   
   })
   
   .catch(function (error) {
   // Handle errors, you can display an error message here
   console.error(error);

   });
   }*/
   var qupdatas = document.getElementById("popup-inner").querySelectorAll("input,select");
   console.log(qupdatas)
   function updatedetails(id){
    uongoing = "Going"
  var tobeupdatedata = [];
  var tobeupdatehead = [];

           var updatas = document.getElementById("popup-inner").querySelectorAll("input,select");
           for (var f =0;f<updatas.length-1;f++ ){

            
            if (String(updatas[f].value) !== String(vdatas[id-2][f])){
              tobeupdatehead.push(vheads[f]);
              tobeupdatedata.push(updatas[f].value);
            }
           }
           if (tobeupdatedata.length==0){
            alert("No Changes Done")
           }
           else{
            togglePopup()
            document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Updating....";
            var datastring = JSON.stringify({
        index:id,
        heads:tobeupdatehead,
        datas:tobeupdatedata
      });
      console.log(datastring)
       fetch(
    
    "https://script.google.com/macros/s/AKfycbzLylL8kY3apC-laODAruF34VvDqCZEUJEg7lH3P1Gx0JgLieMqhQgKHmXIQfF-6ksG/exec",
    {
      redirect: "follow",
      method: "POST",
      body: datastring,
      headers: {
        "Content-Type": "text/plain;charset=utf-8",
      },
    }
   )
   
    .then(function (response) {
   
      // Check if the request was successful
      if (response) {
   
        return response; // Assuming your script returns JSON response
      } else {
        throw new Error("Failed to fetch.");
      }
    })
    .then(async function (data) {
   const result1 = await data.json();
   
   var r = result1.data2;
   console.log(r);
   fetchd ();
   if (r=="Success"){
   document.getElementById("loader").style.display="none"; 
     document.getElementById("message").textContent = "Updated";
    document.getElementById("message").style.display = "block";
     setTimeout(function () { document.getElementById("load").style.display="none";
   uongoing="";
  
   },2000);
  }
   })
   
   .catch(function (error) {
   // Handle errors, you can display an error message here
   console.error(error);
   document.getElementById("loader").style.display="none"; 
   document.getElementById("message").textContent =
   "Failed to update.";
   document.getElementById("message").style.display = "block";
   setTimeout(function () { document.getElementById("load").style.display="none";
   uongoing="";
  
   },2000);
   });
  }
   }
function addstudent(button){
  uongoing = "Going"
var values = [];
var vheads = [];
           var updatas = document.getElementById("popup-inner-add").querySelectorAll("input,select");
           for (var f =0;f<updatas.length-1;f++ ){
            console.log(updatas[f].value,updatas[f].required);
            console.log(updatas[f].value==""&&updatas[f].required);
            if(updatas[f].value==""&&updatas[f].required){
              alert("Enter the "+updatas[f].name);
           
              return;
            }
            else{
values.push(updatas[f].value)
vheads.push(updatas[f].name)

            }
           }
           console.log(updatas[3].value)
           if(updatas[3].value.includes("B.Tech")){
            values.push("B.Tech");
            vheads.push("UG or PG")
           }
           else{
            values.push("M.Tech")
            vheads.push("UG or PG")
           }
           for (var f =0;f<updatas.length-1;f++ ){
           updatas[f].value="";
           }
            togglePopup40()
            document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Adding Student....";
           console.log(values,vheads)
            var datastring = JSON.stringify({
  data:values,
  head:vheads
      });
      console.log(datastring)
      fetch(
    
    "https://script.google.com/macros/s/AKfycbx1fm56dXBmieFrmmVAUDcP_WtIIsYwrS_z071c_vkcxczt6lV_nC0-idhsTsjqdPnLiA/exec",
    {
      redirect: "follow",
      method: "POST",
      body: datastring,
      headers: {
        "Content-Type": "text/plain;charset=utf-8",
      },
    }
   )
   
    .then(function (response) {
   
      // Check if the request was successful
      if (response) {
   
        return response; // Assuming your script returns JSON response
      } else {
        throw new Error("Failed to fetch.");
      }
    })
    .then(async function (data) {
   const result1 = await data.json();
   
   var r = result1.data2;
   console.log(r);
   fetchd ();
   if (r=="Success"){
   document.getElementById("loader").style.display="none"; 
     document.getElementById("message").textContent = "Student Added";
    document.getElementById("message").style.display = "block";
     setTimeout(function () { document.getElementById("load").style.display="none";
   uongoing="";
  
   },2000);
  }
  else if(r=="reject"){
    document.getElementById("loader").style.display="none"; 
     document.getElementById("message").textContent = "ID Number already present. So, Student not added";
    document.getElementById("message").style.display = "block";
     setTimeout(function () { document.getElementById("load").style.display="none";
   uongoing="";
  
   },2000);
  }
   })
   
   .catch(function (error) {
   // Handle errors, you can display an error message here
   console.error(error);
   document.getElementById("loader").style.display="none"; 
   document.getElementById("message").textContent =
   "Failed to update.";
   document.getElementById("message").style.display = "block";
   setTimeout(function () { document.getElementById("load").style.display="none";
   uongoing="";
  
   },2000);
   });
  } 

   
  /*setTimeout(() => {
  
  updatelogstatus("Online");
  
  }, 2000)
  window.addEventListener("blur", () => {
    updatelogstatus("Offline");   
    });
    window.addEventListener("focus", () => {
    updatelogstatus("Online");   
    });
  //window.unblur = colse();
  const beforeUnloadHandler = (event) => {  
    updatelogstatus("Offline");  
  };
  window.addEventListener("beforeunload", beforeUnloadHandler);*/
     </script>
     
  <script src="script1.js"></script>
 
</html>
