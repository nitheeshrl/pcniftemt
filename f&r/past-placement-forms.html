<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Past Forms</title>
  <link rel="icon" href="white_logo.png" type="image/x-icon">
  <link rel="stylesheet" href="style 3.css">
  <script type="text/javascript" src="app.js" defer></script>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" href="style 1.css" />
  <link rel="stylesheet" type="text/css" href="style 2.css">
 <style>
    table .approve{
       border-radius: 20px;
       padding: 10px;
       color: white;
       font-weight: bolder;
background-color: green;
margin-right: 20px;
text-decoration: none;
cursor: pointer;
}
table .decline{
border-radius: 20px;
padding: 10px;
color: white;
font-weight: bolder;
background-color: red;
margin-right: 20px;
text-decoration: none;
cursor: pointer;
}
.tablebee{
display: none;
}
.btn{
background-color:#182d8b;
margin-right: 20px;
text-decoration: none;
color: white;
border-radius: 20px;
padding: 20px;
cursor: pointer;
}
.btn1{
background-color:#182d8b;
height: 40px;
text-decoration: none;
color: white;
border-radius: 20px;
padding:12px;
cursor: pointer;
font-weight: bold;
}
.dropdown {
  position: relative;
  display: inline-block;
}
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content label {
margin-left: 20px;
  margin-top: 10px;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: left;
  gap: 20px;
}
</style>
<script>
  function logout(){
    updatelogstatus("Offline");  
    localStorage.removeItem("loggedname")
    window.location="../logout.html";
  }
  function userPopup(){
        console.log("ok")
document.getElementById("popup-4").classList.toggle("active");
}
function logoutPopup(){
        console.log("ok")
document.getElementById("popup-3").classList.toggle("active");

}
function inactivePopup(formname){
        console.log("ok")
document.getElementById("popup-6").classList.toggle("active");
console.log(document.getElementById("inbt").onclick)
var val = "forminactive(`"+formname+"`)"
document.getElementById("inbt").setAttribute("onclick",val);;
console.log(document.getElementById("inbt").onclick)
}
function activePopup(fore){
  var ot =  document.getElementById("uservaluess").children;
fore = fore.split("/ll/")
var formname = fore [0];
var userss = fore[1];
console.log(fore);
for (var h=0; h<ot.length; h++){

    var eachuser = ot[h].children[0].value;
 if(userss.includes(eachuser)){
  ot[h].children[0].checked=true;
  ot[h].style.display="flex";
 }
 else{
  ot[h].children[0].checked=false;
  ot[h].style.display="none";
 }
  
}
ot[0].style.display="flex";
ot[1].style.display="flex";
if (userss==""){
  ot[0].children[0].checked=true;
ot[1].children[0].checked=true;
}
getSelectedValues();
        console.log("ok")
document.getElementById("popup-7").classList.toggle("active");
console.log(document.getElementById("actbt").onclick)
var val = "formactive(`"+formname+"`)"
document.getElementById("actbt").setAttribute("onclick",val);;
console.log(document.getElementById("actbt").onclick)
}
</script>
</head>
<body>
  <nav id="sidebar">
    <ul>
      <li class="indetails" id="insname">
        <div style="width: 50px; display: flex;gap: 10px;">
          <img style="width: 50px;" src="white_logo.png" alt="">
          <span style="color: white;">NIFTEM-T <br> Placement Cell</span>
        </div>
        
        <button onclick=toggleSidebar() id="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z"/></svg>
        </button>
      </li>
      <li class="outdetails" id="outlogo" style="">
        <button class="out-items" onclick=toggleSidebar1() id="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z"/></svg>
        </button>
        <img class="out-items" style="width: 50px;" src="white_logo.png" alt="">
        <img id="profileimage1" style=" scale:90%;border-radius: 50px; width: 50px; height: 50px; " src=".//1.png" alt="" srcset="">
       
      </li>
      <li class="indetails"  id="insprofile" style="left: 0px;">
        <div class="log-items" style="flex-direction: column; gap: 0px; align-items: center;justify-content: center;">
         <a onclick="userPopup()"><img id="profileimage" style=" scale:200%;border-radius: 50px; width: 50px; height: 50px; " src=".//1.png" alt="" srcset=""></a>
       <div style="background-color: white; color: black; padding: 10px;border-radius: 40px;">
        <p ><span id="mname">Nitheesh R L</span></p>
       </div>
       

          </div>

      </li>
      <li>
        <a href="dash.html">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M520-640v-160q0-17 11.5-28.5T560-840h240q17 0 28.5 11.5T840-800v160q0 17-11.5 28.5T800-600H560q-17 0-28.5-11.5T520-640ZM120-480v-320q0-17 11.5-28.5T160-840h240q17 0 28.5 11.5T440-800v320q0 17-11.5 28.5T400-440H160q-17 0-28.5-11.5T120-480Zm400 320v-320q0-17 11.5-28.5T560-520h240q17 0 28.5 11.5T840-480v320q0 17-11.5 28.5T800-120H560q-17 0-28.5-11.5T520-160Zm-400 0v-160q0-17 11.5-28.5T160-360h240q17 0 28.5 11.5T440-320v160q0 17-11.5 28.5T400-120H160q-17 0-28.5-11.5T120-160Zm80-360h160v-240H200v240Zm400 320h160v-240H600v240Zm0-480h160v-80H600v80ZM200-200h160v-80H200v80Zm160-320Zm240-160Zm0 240ZM360-280Z"/></svg>
          <span>Dashboard</span>
        </a>
      </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h207q16 0 30.5 6t25.5 17l57 57h320q33 0 56.5 23.5T880-640v400q0 33-23.5 56.5T800-160H160Zm0-80h640v-400H447l-80-80H160v480Zm0 0v-480 480Zm400-160v40q0 17 11.5 28.5T600-320q17 0 28.5-11.5T640-360v-40h40q17 0 28.5-11.5T720-440q0-17-11.5-28.5T680-480h-40v-40q0-17-11.5-28.5T600-560q-17 0-28.5 11.5T560-520v40h-40q-17 0-28.5 11.5T480-440q0 17 11.5 28.5T520-400h40Z"/></svg>
          <span>Brochure Update</span>
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu">
          <div>
            <li><a href="index.html">Active Requests</a></li>
            <li><a href="past.html">Past Requests</a></li>
            <li><a  target="_blank" href="https://niftemt-placementcell-forms.pages.dev/B2K21%20Brochure%20Details%20Update/user">Request Form</a></li>
          </div>
        </ul>
      </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m221-313 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-228q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm0-320 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-548q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm339 353q-17 0-28.5-11.5T520-320q0-17 11.5-28.5T560-360h280q17 0 28.5 11.5T880-320q0 17-11.5 28.5T840-280H560Zm0-320q-17 0-28.5-11.5T520-640q0-17 11.5-28.5T560-680h280q17 0 28.5 11.5T880-640q0 17-11.5 28.5T840-600H560Z"/></svg>
          <span>Forms</span>
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu show">
          <div>
            
            <li><a href="new-placement-form.html">New Placement Form</a></li>
            <li class="active"><a  href="past-placement-forms.html">Old Placement Forms</a></li>
            <li><a href="new-form.html">New Form</a></li>
            <li><a  href="past-forms.html">Old Forms</a></li>
          </div>
        </ul>
      </li>
      <li>
       
          <button onclick=toggleSubMenu(this) class="dropdown-btn">
          
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-240v-32q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v32q0 33-23.5 56.5T720-160H240q-33 0-56.5-23.5T160-240Zm80 0h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z"/></svg>
            <span>Profile</span>
   
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
          </button>
        <ul class="sub-menu">
          <div>
            <li><a href="change-pass-1.html">Change Password</a></li>
            <li><a onclick="passkey()">Create PassKey</a></li>
            <li><a onclick="logoutPopup()" >Logout</a></li>
          </div>
        </ul>
      </li>

    </ul>
  </nav>
  <main>
    <div class="container" onclick="closeAllSubMenus()">
      <main style="" class="table" id="customers_table">
        <section class="table__header">

            <div class="input-group">
                <input  type="search" placeholder="Search..." >
                <img src="images/search.png" alt="">
            </div>

        </section>

       <section id="tablebee" class="tablebee">         
        <section  class="table__body" >
            <table>
                <thead>
                  <tr id="tabheaddetails">
                        <th><b>Form Name</b></th>
                        <th><b>Status</b></th>
                        <th><b>Live Time</b></th>
                        <th><b>Expiry Time</b></th>
                        <th><b>Status Change</b></th>
                        <th><b>Form Link</b></th>
                        <th><b>Response Link</b></th>
                        <th><b>Delete</b></th>
                    </tr>
                </thead>
                <tbody id="tabdetails" >

                </tbody>
            </table>

        </section>
    </section> 

    <section class="msg" >

        <h1 style="text-align: center;"></h1>
        <div   id="dfiled" style="align-content:normal; margin-left: 0px;margin-right: auto; margin-top: 30px;"><p style="text-align: left;">
            <div ></div> <span id = "status" style="color: black;"></span></p></div>
            </p>
            </section>
            <section style="height: 100px; display: flex;justify-content: center;">
      
            </section>
    </main>
    <div id="load" class="load" > 
        <div class="loader" id="loader"> 
      
          </div> 
          <div
            id="message"
          class="message"
          style="width: 350px;"
            ></div>
        </div>      
        <div class="popup1" id="popup-3">
 
          <div class="overlay"></div>
      
          <div class="content">
      
          <div class="close-btn" onclick="togglePopup3()">&times;</div>
      
          <h1 style="margin-top: 50px;">Are you sure to logout?</h1>
      
          <p style="margin-bottom: 40px;"> </p>
          <div >
              <input id="aid" type="hidden" value="">
      <a class="btn" id="apbt" onclick="logout()">Yes</a>
      <a class="btn" onclick="togglePopup3()">Cancel</a>
          </div>
          </div>
      
          </div>
          <div class="popup" id="popup-1">
 
            <div class="overlay"></div>
        
            <div class="content">
        
            <div class="close-btn" onclick="togglePopup()">&times;</div>
        
            <h1 style="margin-top: 50px;">Confirm Update Approval</h1>
        
            <p style="margin-bottom: 40px;">Are you sure you wish to approve the Brochure details update? </p>
            <div >
                <input id="aid" type="hidden" value="">
        <a class="btn" id="apbt" onclick="approve()">Confirm</a>
        <a class="btn" onclick="togglePopup()">Cancel</a>
            </div>
            </div>
        
            </div>
      <div class="popup" id="popup-2">
  
          <div class="overlay"></div>
      
          <div class="content" style="height:400px;">
      
          <div class="close-btn" onclick="togglePopup2()">&times;</div>
      
          <h1 style="margin-top: 50px;">Confirm Update Decline</h1>
      
          <p style="margin-bottom: 40px;">Are you sure you wish to decline the Brochure details update? </p>
          <div >
              <div class="form-element" style=" flex-direction: column;align-items: flex-start; width: 100%;margin-bottom: 40px;">
                  <span class="q" >Reason for decline</span>
                  <input type="text" name="Reason" id="Reason" style="width: 100%;" placeholder="Enter the reason" />
                  </div>
                  <input id="did" type="hidden" value="">
      <a class="btn" id="decbt" onclick="decline()" style="background-color: red;">Decline</a>
      <a class="btn" onclick="togglePopup2()">Cancel</a>
          </div>
          </div>
      
          </div>
          <div class="popup" id="popup-6">
  
            <div class="overlay"></div>
        
            <div class="content" style="height:400px;">
        
            <div class="close-btn" onclick="togglePopup6()">&times;</div>
        
            <h1 style="margin-top: 50px;">Make form inactive</h1>
        
            <div >
<div class="form-element radio-buttons" style="display: flex;flex-direction: column;align-items: center;align-items: first baseline; left: 20px;width: 100%;margin-top: 40px;margin-left: 60px;">
<label for="Immediately">
<input
onclick="settimeoption(this)"
type="radio"
name="Type of Inactive Status Change"
class="Type of Inactive Status Change"
required 
id="Immediately"
value="Immediately"

/>
<span>Immediately</span>
</label>
<label for="Set Time and Date">

<input
onclick="settimeoption(this)"
type="radio"
name="Type of Inactive Status Change"
class="Type of Inactive Status Change"
id="Set Time and Date"
value="Set Time and Date"

/>
<span>Set Time and Date</span>
</label>
<input min=""  type="datetime-local" id="setinactive time" style="display: none;width: 60%;">
</div>
                    <input id="inid" type="hidden" value="">
        <a class="btn" id="inbt" onclick="" style="background-color: red;">Make Inactive</a>
        <a class="btn" onclick="togglePopup6()">Cancel</a>
            </div>
            </div>
        
            </div>
            <div class="popup" id="popup-7">
  
              <div class="overlay"></div>
          
              <div class="content" style="height:450px;">
          
              <div class="close-btn" onclick="togglePopup7()">&times;</div>
          
              <h1 style="margin-top: 50px;">Make form active</h1>
          
              <div >
  <div class="form-element radio-buttons" style="display: flex;flex-direction: column;align-items: center;align-items: first baseline; left: 20px;width: 100%;margin-top: 40px;margin-left: 60px;">
  <label for="Immediately">
  <input
  onclick="setacttimeoption(this)"
  type="radio"
  name="Type of Active Status Change"
  class="Type of Active Status Change"
  required 
  id="Immediately"
  value="Immediately"
  
  />
  <span>Immediately</span>
  </label>
  <label for="Set Time and Date">
  
  <input
  onclick="setacttimeoption(this)"
  type="radio"
  name="Type of Active Status Change"
  class="Type of Active Status Change"
  id="Set Time and Date"
  value="Set Time and Date"
  
  />
  <span>Set Time and Date</span>
  </label>
  <input min=""  type="datetime-local" id="setactive time" style="display: none;width: 60%;">
  </div>
  <div class="dropdown" style="display: flex;flex-direction: column;width: 100%; margin-top: -20px; margin-bottom: 50px;justify-content: left;align-items: start;">
    <span class="q">Change form access</span>
    <div style="display: flex;width: 100%;">
    <input type="text" placeholder="Select the peoples" style="width: 100%;" value="All M.Tech, All B.Tech">
   <button style="margin-left: -20px;height: 20px;padding: 20px;text-align: center;" onclick="sel()"> V </button>
  </div>
   <div class="dropdown-content" style="margin-top: 60px;width: 100%;overflow:scroll; height:200px;" id ="uservaluess" ">
    <label onclick="getSelectedValues(this)"><input type="checkbox" checked value="All M.Tech">All M.Tech</label>
    <label onclick="getSelectedValues(this)"><input type="checkbox" checked value="All B.Tech">All B.Tech</label>
   </div>
    </div>
                      <input id="actid" type="hidden" value="">
          <a class="btn" id="actbt" onclick="" style="background-color: red;">Make Active</a>
          <a class="btn" onclick="togglePopup7()">Cancel</a>
              </div>
              </div>
          
              </div>
    </div>
   
  </main>
  
</body>
<script src="https://unpkg.com/@simplewebauthn/browser/dist/bundle/index.umd.min.js"></script>
<script>
  var userdsta = "";
  var porfilepicback = sessionStorage.getItem("backprofilepic");
  if (porfilepicback!==null){
    document.getElementById("profileimage").src = porfilepicback;
    document.getElementById("profileimage1").src = porfilepicback;
  }
function settimeoption(button){
  console.log(button.value)
if(button.value=="Set Time and Date"){
var time = document.getElementById("setinactive time");
var today = formatDateto();
var ttoday = new Date().toISOString().slice(0, 16);
console.log(today)
console.log(ttoday)
time.min = today;
time.style.display="flex";
}
else{
  var time = document.getElementById("setinactive time");
time.style.display="none";
}
}
function setacttimeoption(button){
  console.log(button.value)
if(button.value=="Set Time and Date"){
var time = document.getElementById("setactive time");
var today = formatDateto();
var ttoday = new Date().toISOString().slice(0, 16);
console.log(today)
console.log(ttoday)
time.min = today;
time.style.display="flex";
}
else{
  var time = document.getElementById("setactive time");

time.style.display="none";
}
}
  function notavailable(){
    alert("Not Available")
  }
const  GetUniqueID = () =>{
const uniqueID = localStorage.getItem("Passkey-uniqueID");
if (uniqueID == undefined){
const newUniqueID = crypto.randomUUID();

return [newUniqueID, "New"];
}
else {
return uniqueID;
}
}
async function passkey(){
           var passdevuniid =GetUniqueID();
           console.log(passdevuniid);
if (passdevuniid[1] ==  "New"){
 document.getElementById("loader").style.display="block"; 
           document.getElementById("load").style.display="initial";
           document.getElementById("message").textContent="Registering PassKey....";
         
       var passkeysss ={};
var fetchurl = "https://passkey-5ev6.onrender.com";
       const { startRegistration, startAuthentication } = SimpleWebAuthnBrowser;
           const url = new URL(window.location)
           const username = localStorage.getItem("loggedname");
           var weburl = location.hostname;
           console.log(weburl)
           const response = await fetch(fetchurl+'/register-challenge', {
               method: 'POST',
               headers: {
                   'Content-Type': 'application/json'
               },
               body: JSON.stringify({ username, weburl })
           })

           const challengeResult = await response.json()
           const { options } = challengeResult // Server side challenge

           const authenticationResult = await startRegistration({optionsJSON: options})
           console.log(authenticationResult)

           var urlorigin= location.protocol+"//"+location.host;
           console.log(urlorigin)
           var create_passkey = await fetch(fetchurl+'/register-verify', {
               method: 'POST',
               headers: {
                   'Content-Type': 'application/json'
               },
               body: JSON.stringify({ username, cred: authenticationResult, challenge: options.challenge, devUniId:passdevuniid[0], weburl,urlorigin })
           })
           const create_passkeyResult = await create_passkey.json();
           console.log(create_passkeyResult.result)
           
           
passkeysss = create_passkeyResult.info;
console.log(create_passkeyResult.info);
if (create_passkeyResult.info.userVerified){
 localStorage.setItem("Passkey-uniqueID",passdevuniid[0]);
 document.getElementById("loader").style.display="none"; 
document.getElementById("message").textContent="PassKey Registered Successfully";
setTimeout(function () { 
 document.getElementById("load").style.display="none";
},2000);
}


}
else{
alert("PassKey is already created for this Device")
}
}
       function approvePopup(id){
           console.log("ok")
   document.getElementById("popup-1").classList.toggle("active");
   document.getElementById("aid").value = id;
   
   }

   function togglePopup(){
   document.getElementById("popup-1").classList.toggle("active");
   }
   function declinePopup(id){
       console.log("ok")
   document.getElementById("popup-2").classList.toggle("active");
   document.getElementById("did").value = id;
   
   }
   function togglePopup2(){
   document.getElementById("popup-2").classList.toggle("active");
   }
   function togglePopup3(){
   document.getElementById("popup-3").classList.toggle("active");
   }
   function togglePopup4(){
   document.getElementById("popup-4").classList.toggle("active");
   }
   function togglePopup6(){
    uncheckoptions()
   document.getElementById("popup-6").classList.toggle("active");
   document.getElementById("setinactive time").style.display="none";
   const d =   document.querySelectorAll('input[type=datetime-local]');
   console.log(d)
   d[0].value = 0
   }
   function togglePopup7(){
    uncheckoptions()
   document.getElementById("popup-7").classList.toggle("active");
   document.getElementById("setactive time").style.display="none";
   const d =   document.querySelectorAll('input[type=datetime-local]');
   console.log(d)
   d[1].value = 0
   }
   function uncheckoptions(){
    if(ustatus!=="Going"){
    var options = document.querySelectorAll('input[type="radio"]');
    for(var i=0;i<options.length;i++){
      options[i].checked=false;
    }
   }
  }
   var fetchurl ="";
         var uname ;
         const keyvalues = window.location.search;
     const value = new URLSearchParams(keyvalues);
     var idvalue = value.get('ui');
     
  
 
     var uids = [
       "398",
       "756",
       "652",
       "235",
       "453",
      "648",
       "378",
       "345",
       "904",
       "413",
       "254",
       "890",
       "333",
       "333",
       "333",
       
   ];
   var uorps = [
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "M.Tech",
    "M.Tech",
    "M.Tech",
    "M.Tech",
    "M.Tech",
     "M.Tech"
   ]
   var inames = [
   'Anandha Keerthy M',
   'Anindit Bizy Nair',
   'David Evander Jebson S',
   'Keerthika P',
   'Nitheesh R L',
   'Shivam Jha',
   'Srinithi C P',
   'Subbu Krishna Sharma GM',
   'Yuvashreekantham R',
   'R B Ramyaa',
   'Anjali S',
   'Mathangi G',
   'Srivigneswar S',
   'Sathishwaran S',
   'Sample'
   ]
   var photourls =[
 'https://npics.pages.dev/1.jpg',
'https://npics.pages.dev/2.jpg',
'https://npics.pages.dev/3.jpg',
'https://npics.pages.dev/4.jpg',
'https://npics.pages.dev/5.jpg',
'https://npics.pages.dev/6.jpg',
'https://npics.pages.dev/7.jpg',
'https://npics.pages.dev/8.jpg',
'https://npics.pages.dev/9.jpg',
'https://npics.pages.dev/10.jpg',
'https://npics.pages.dev/11.jpg',
'https://npics.pages.dev/12.jpg',
'https://npics.pages.dev/13.jpg',
'https://npics.pages.dev/14.jpg',
'https://npics.pages.dev/0.jpg'

 ]
   var iurls = [
'https://script.google.com/macros/s/AKfycbxzHeGu3z7ChHoOQf4Lw1qgvY1kUL8lAs0mQAmTkwYaELXnCVy6gUm3nmUNHfhh0EGsOQ/exec',
'https://script.google.com/macros/s/AKfycbw6wbhOcrcyoOFuRn8RPSgZxdLnFbROVG2C6gu033ep9l6kk8GRFg6fKJQVX-yvzaOyrA/exec',
'https://script.google.com/macros/s/AKfycby0bpezZTGSTIBGxkSa4LymvbBYP68ro7LJ_aeL-TpRwoUtgq7J9jGtlNrPrpSFtLdMPw/exec',
'https://script.google.com/macros/s/AKfycbyPmVOKmWhJLFSSrXJucIFWn4HLqE5R-YaFy7fUfgd65GvuodABle1vHoQyK-idGYlq/exec',
'https://script.google.com/macros/s/AKfycbxEp-AGZgECifFXwbKOWXrVlKItShDBaqlQy1nNGXElI6BR6SJVeHntpWOBvT4GvkJFOA/exec',
'https://script.google.com/macros/s/AKfycbwXeCVS5KRLG_-fivdhmhV3Gj8mRPEDkDnqXeSsJFglqDmSHOeEk5snIeq3ujxGrUM/exec',
'https://script.google.com/macros/s/AKfycbyJ1XeGgRqAjR44TB_hTjLEyCMA7XHhv5hASQdRp2LqnAYxcfUm3NmYeHTZP7MwJRea/exec',
'https://script.google.com/macros/s/AKfycbx6MTdLho6wKtsbAZYfTym8KS_3NdNTzhyQD29Ls8Ww9Bk1Nuw40-kF1KWSTAJY90d2/exec',
'https://script.google.com/macros/s/AKfycby_oUg1_sTnZF5kTyG70JaA0DN_fSwhmFfnqph-Wnc-EU1UuvRxDahY_acAlwt9udo/exec',
'https://script.google.com/macros/s/AKfycbzQNai3ZVI_FxloADEK1zaj1KfzIxi-916CK1GgdWVYSWYPsTOkvTqhDcaDWw1AMG6flg/exec',
'https://script.google.com/macros/s/AKfycbxj_gCuRgJZ-Yu5QJAd-wMlvNonVPXHQV-mnGjr4d5Hz-a0x47brR-9byzQT8eyZSRS/exec',
'https://script.google.com/macros/s/AKfycbyVtGzaKOxucJJkHbNPjPHQvRV-PirSwetae8B2He_zgh9TnbKvHKKAgIzXzOy03-cS/exec',
'https://script.google.com/macros/s/AKfycbyD2RB2ak-oFcJgzF6J_AyV7D3hk4sp6V7H835NbL22S0kxCFJt1A16HW059pBmJOMj/exec',
'https://script.google.com/macros/s/AKfycbzGzDbJnrdaAQswQY05tvv8WWG6I6gI9TKbq-HP0QF6-N-Ko2v78v97euY6erkOKw/exec',
'https://script.google.com/macros/s/AKfycbw2vmyE-I2iQHjOS3BQHdqaNBjHlPdJ9sIPwyQgH8pZMQO2gpilLcOIvKJG-N067LbG/exec'
   ]
   for (var i = 0; i < uids.length; i++) {
     uname = localStorage.getItem("loggedname");
     console.log(uname)
     if (uname == inames[i]){
       idvalue = uids[i];
   fetchurl = iurls[i];
   console.log(document.getElementById("profileimage"))
   sessionStorage.setItem("backprofilepic",photourls[i]);
   document.getElementById("profileimage").src = photourls[i];
   document.getElementById("profileimage1").src = photourls[i];
   console.log(document.getElementById("profileimage").src,photourls[i])

     }
   }
   console.log(uname)
   console.log(fetchurl)

   document.getElementById("mname").innerHTML = uname;
   if (idvalue == undefined||uname==undefined){
     alert("You are not logged in. Please log in");
     window.location="../index.html";
   }
   document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Fetching forms....";
      function fetchd (){
       console.log("fetch")
       var details ="";
       fetch(
    
    "https://script.google.com/macros/s/AKfycbwwHB9VvJR94E55QmmMgxK22ZLjUcaMGjQEkfV_8mqkAvuEiIzj_skEImvAI7ULhQOI/exec",
    {
      redirect: "follow",
      method: "POST",
      body: uname+"/Placement Forms",
      headers: {
        "Content-Type": "text/plain;charset=utf-8",
      },
    }
   )
   
    .then(function (response) {
   
      // Check if the request was successful
      if (response) {
   
        return response; // Assuming your script returns JSON response
      } else {
        throw new Error("Failed to fetch.");
      }
    })
    .then(async function (data) {
   const result1 = await data.json();
   
   var r = result1.data2[0];
   var userrole =result1.data2[1];
   var uservalues = result1.data2[2];
   var uservaluesuorp = result1.data2[3];
if (userdsta !=="done"){
  var valuess = `<label onclick="getSelectedValues(this)"><input type="checkbox" checked value="All M.Tech">All M.Tech</label>
  <label onclick="getSelectedValues(this)"><input type="checkbox" checked value="All B.Tech">All B.Tech</label>`;
  var ot =  document.getElementById("uservaluess").children;
  for(var e=0;e<uservalues.length-1; e++){
   
    var value = `<label style="display: none;" onclick="getSelectedValues(this)"><input type="checkbox" value="`+uservalues[e]+`">`+uservalues[e]+" ("+uservaluesuorp[e]+")"+`</label>`
    valuess += value;

  }
  document.getElementById("uservaluess").innerHTML=valuess;
  userdsta ="done";
}
   if(userrole=="Admin"){
    var tabheadsdetail =
    `<th><b>Form Name</b></th>
<th><b>Status</b></th>
<th><b>Created By</b></th>
<th><b>Live Time</b></th>
<th><b>Expiry Time</b></th>
<th><b>Form Access Peoples</b></th>
<th><b>Status Change</b></th>
<th><b>Preview Link</b></th>
<th><b>Form Link</b></th>
<th><b>Response Link</b></th>
<th><b>Delete</b></th>`
    document.getElementById("tabheaddetails").innerHTML= tabheadsdetail
   }
   else if (userrole=="User"){
    var tabheadsdetail =
    `<th><b>Form Name</b></th>
<th><b>Status</b></th>
<th><b>Live Time</b></th>
<th><b>Expiry Time</b></th>
<th><b>Form Access Peoples</b></th>
<th><b>Status Change</b></th>
<th><b>Preview Link</b></th>
<th><b>Form Link</b></th>
<th><b>Response Link</b></th>
<th><b>Delete</b></th>`
    document.getElementById("tabheaddetails").innerHTML= tabheadsdetail
   }
   console.log(r);
   for(var k=0; k<r.length;k++){
       var detail ="";
   
       var head = r[k][0]
       var formstatus = r[k][1]
       var formlink = r[k][2]
       var responselink = r[k][3];
       var folderid=r[k][7]
       var livetime;
       var fdta =r[k][0]+"/ll/"+r[k][8];
       if (r[k][8]==""&&formstatus=="Live"){
       var acpeo = "All M.Tech, All B.Tech";
       }
       else{
        var acpeo = r[k][8];
       }
       if(r[k][4]!==""){
        livetime = r[k][4]
       }
       else{
        livetime = r[k][4]
       }
       var expirytime
       if(r[k][5]!==""){
        expirytime = r[k][5]
       }
       else{
        expirytime = r[k][5]
       }
       var formowner="";
       if(userrole=="Admin"){
        formowner = '<td>'+r[k][6]+'</td>';
       }
       formlink= "https://spcniftemt.pages.dev/placement-form/?form="+folderid

  
       var prelink ="https://pcniftemt.pages.dev/preview-placement-form/?form="+folderid;
       if(formstatus=="Live"){
        detail += '<tr class="lasttr"><td >'+head+'</td><td style="color: green;" >'+formstatus+'</td>'+formowner+'<td>'+livetime+'</td><td>'+expirytime+'</td><td>'+acpeo+'</td><td ><button class="btn11" style="background: red;" onclick="inactivePopup(`'+head+'`)" target="_blank">Make Inactive</button></td><td><button class="btn11"'+`onclick=" window.open('`+prelink+`', '_blank')"`+'>View Preview</button></td><td><button class="btn11"'+`onclick=" window.open('`+formlink+`', '_blank')"`+'>View Form</button></td><td><button class="btn11" '+`onclick=" window.open('`+responselink+`', '_blank')"`+'>View Responses</button>'+'</td><td><button class="btn11"  style="background: red;" onclick="deleteform(`'+head+'`)" target="_blank">Delete Form</button>'+'</td></tr>';
       }
       else if(formstatus=="Inactive"){
        detail += '<tr class="lasttr"><td >'+head+'</td><td  style="color: red;">'+formstatus+'</td>'+formowner+'<td>'+livetime+'</td><td>'+expirytime+'</td><td>'+acpeo+'</td><td ><button class="btn11"  style="background: green;" onclick="activePopup(`'+fdta+'`)" target="_blank">Make Live</button></td><td><button class="btn11"'+`onclick=" window.open('`+prelink+`', '_blank')"`+'>View Preview</button></td><td><button class="btn11" '+`onclick=" window.open('`+formlink+`', '_blank')"`+'>View Form</button></td><td><button class="btn11" '+`onclick=" window.open('`+responselink+`', '_blank')"`+'>View Responses</button>'+'</td><td><button class="btn11"  style="background: red;" onclick="deleteform(`'+head+'`)" target="_blank">Delete Form</button>'+'</td></tr>';
       }
       else{
   
        detail += '<tr class="lasttr"><td >'+head+'</td><td style="color: orange;">'+formstatus+'</td>'+formowner+'<td>'+livetime+'</td><td>'+expirytime+'</td><td>'+acpeo+'</td><td ><button class="btn11" style="background: green;"  onclick="activePopup(`'+fdta+'`)" target="_blank">Make Live</button></td><td><button class="btn11"'+`onclick=" window.open('`+prelink+`', '_blank')"`+'>View Preview</button></td><td><button class="btn11" '+`onclick=" window.open('`+formlink+`', '_blank')"`+'>View Form</button></td><td><button class="btn11" '+`onclick=" window.open('`+responselink+`', '_blank')"`+'>View Responses</button>'+'</td><td><button class="btn11"  style="background: red;" onclick="deleteform(`'+head+'`)" target="_blank">Delete Form</button>'+'</td></tr>';
       }

       details = details + detail;
      
   }
  
   if(ustatus!=="Going"){
   if (details!==""){
   document.getElementById("tabdetails").innerHTML = details;
   document.getElementById("tablebee").style.display = "initial";
   document.getElementById("status").style.display = "none";
   }
   else{
     document.getElementById("tablebee").style.display = "none";
       document.getElementById("status").style.display = "initial";
       document.getElementById("status").textContent = "No Past Placement Forms";

   }
   document.getElementById("loader").style.display="none"; 
                   document.getElementById("message").textContent = "";
                   document.getElementById("load").style.display = "none";
  }
           
   })
   
   .catch(function (error) {
   // Handle errors, you can display an error message here
   console.error(error);
   document.getElementById("loader").style.display="none"; 
   document.getElementById("message").textContent =
   "Failed to fetch.";
   document.getElementById("message").style.display = "block";
   });
      }
      fetchd ();
   
   function approve(){
     var id =  document.getElementById("aid").value;
     id = id.split("/");
     
       console.log(id);
       togglePopup();
       var updatede = id[0]+"/"+"Approve"+"/"+"";
       updatedetails(updatede,id[0],id[1]);
   }
   function decline(){
       var id =  document.getElementById("did").value;
       id = id.split("/");
       var Reason =  document.getElementById("Reason").value;
       console.log(id);
       console.log(Reason);
       if(Reason!==""){
       togglePopup2();
       var updatede = id[0]+"/"+"Decline"+"/"+Reason;
       updatedetails(updatede,id[0],id[1]);
       }
       else{
           alert("Enter the reason for decline")
       }
   }
   function sendmail (name,id){
     
     document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Sending Mail to "+name+"...";
           
           
             console.log(id)

   fetch(
    
                 fetchurl,
                 {
                   redirect: "follow",
                   method: "POST",
                   body: id,
                   headers: {
                     "Content-Type": "text/plain;charset=utf-8",
                   },
                 }
               )
       
                 .then(function (response) {
       
                   // Check if the request was successful
                   if (response) {
                
                     return response; // Assuming your script returns JSON response
                   } else {
                     throw new Error("Failed to send the mail.");
                   }
                 })
                 .then(async function (data) {
           const result1 = await data.json();
     
           var r = result1.data2;
   console.log(r);
   if(r == "sent"){
       document.getElementById("loader").style.display="none"; 
                   document.getElementById("message").textContent =
                    "Mail Sent to "+name;
                   document.getElementById("message").style.display = "block";
                   setTimeout(function () { document.getElementById("load").style.display="none"; },2000);
   
                 
   }
   
   
         })
   
         .catch(function (error) {
           // Handle errors, you can display an error message here
           console.error(error);
           document.getElementById("loader").style.display="none"; 
           document.getElementById("message").textContent =
             "Failed to Send the Mail.";
           document.getElementById("message").style.display = "block";
         });
   }
   function updatedetails(updatestring,id,name){
       document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Proceesing the request....";
           
       fetch(
    
    "https://script.google.com/macros/s/AKfycbxnl13iMMpRvTpLJW0I5JzGq5jkk4v2f1N7YyjCUVVYAdbrlrLdDjP5Mr517_fG2QOn/exec",
    {
      redirect: "follow",
      method: "POST",
      body: updatestring,
      headers: {
        "Content-Type": "text/plain;charset=utf-8",
      },
    }
   )
   
    .then(function (response) {
   
      // Check if the request was successful
      if (response) {
   
        return response; // Assuming your script returns JSON response
      } else {
        throw new Error("Failed to fetch.");
      }
    })
    .then(async function (data) {
   const result1 = await data.json();
   
   var r = result1.data2;
   console.log(r);
   fetchd ();
   document.getElementById("loader").style.display="none"; 
     document.getElementById("message").textContent = "Processed";
    document.getElementById("message").style.display = "block";
     setTimeout(function () { document.getElementById("load").style.display="none";
   sendmail (name,id);
   
   },2000);
   
   })
   
   .catch(function (error) {
   // Handle errors, you can display an error message here
   console.error(error);
   document.getElementById("loader").style.display="none"; 
   document.getElementById("message").textContent =
   "Failed to fetch.";
   document.getElementById("message").style.display = "block";
   });
   }
   </script>
   <script>
    var ustatus ;
         function deleteform(formname){
          ustatus="Going";
          document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Deleting Form....";
            fetch(
          "https://script.google.com/macros/s/AKfycbzPqJJfTQA47KUxMgNfK1EjhFuDgHrSsaytcJ-Hgf1fRSvvidIXoPp_yeL-_j2fzN8IBw/exec",
          {
            redirect: "follow",
            method: "POST",
            body: formname+"/Placement Forms",
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          }
        )

          .then(async function (response) {

            // Check if the request was successful
            const result1 = await response.json();
            console.log(result1.data2);
            var data = result1.data2;
if(data=="Success"){
  document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent="Form Deleted Successful";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
}
else if(data=="Not Found"){
  
  document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent="Form not found";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
} 
            if (response) {
         
              return response; // Assuming your script returns JSON response
            } else {
              throw new Error("Failed to load the form.");
            }
          })
         /* .then(async function (data) {
            const result1 = await data.json();
            console.log(result1.data2);
            var data = result1.data2;
if(data=="Success"){
  document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent="Form Deleted Successful";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
}
else if(data=="Not Found"){
  
  document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent="Form not found";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
} 
})*/

          .catch(function (error) {
            // Handle errors, you can display an error message here
            console.error(error);
            document.getElementById("message").textContent =
              "An error occurred while submitting the form.";
            document.getElementById("message").style.display = "block";
          });
    }
    function updatestatus(formname,status,userac){
      ustatus="Going";
          document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Changing Status....";
           var formstringgg= formname+"/Placement Forms"+"/"+status+"/"+userac;
           console.log(formstringgg)
          
           if(status=="Live"){
            togglePopup7()
           }
           else{
            togglePopup6()
           }
            fetch(
          "https://script.google.com/macros/s/AKfycbzU6sY0E5g9AolZDs3jd6YbiJKICTnrL0Z4DkGoA00eWt0zVDP52ZFcWsMheamZ4LgZ0g/exec",
          {
            redirect: "follow",
            method: "POST",
            body: formstringgg,
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          }
        )

          .then(async function (response) {
            const result1 = await response.json();
            console.log(result1.data2);
            var data = result1.data2;
if(data=="Success"){
  document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent="Status Changed Successful";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
}
else if(data=="Not Found"){
  
  document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent="Form not found";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
} 
            // Check if the request was successful
            if (response) {
         
              return response; // Assuming your script returns JSON response
            } else {
              throw new Error("Failed to load the form.");
            }
          })
          /*.then(async function (data) {
            const result1 = await data.json();
            console.log(result1.data2);
            var data = result1.data2;
if(data=="Success"){
  document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent="Status Changed Successful";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
}
else if(data=="Not Found"){
  
  document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent="Form not found";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
} 
})*/

          .catch(function (error) {
            // Handle errors, you can display an error message here
            console.error(error);
            document.getElementById("message").textContent =
              "An error occurred while submitting the form.";
            document.getElementById("message").style.display = "block";
          });
    }
    function timeupdatestatus(formname,status,time,userac){
      ustatus="Going";
          document.getElementById("load").style.display="initial";
           document.getElementById("loader").style.display="block"; 
           document.getElementById("message").textContent = "Setting Status Change Time....";
           var formstringgg= formname+"/"+status+"/"+time+"/"+userac;
           console.log(formstringgg)
           if(status=="Live"){
            togglePopup7()
           }
           else{
            togglePopup6()
           }
            fetch(
          "https://script.google.com/macros/s/AKfycbz0JwCYKJuZj6gulNEtMO5K0hd7aSKgzjAIKqbqMCdTEoemwE1oy5l6eeVeuq5SQHI9/exec",
          {
            redirect: "follow",
            method: "POST",
            body: formstringgg,
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          }
        )

          .then(async function (response) {

            // Check if the request was successful
            const result1 = await response.json();
            console.log(result1.data2);
            var data = result1.data2;
if(data=="Success"){
  document.getElementById("loader").style.display="none"; 
  const d =   document.querySelectorAll('input[type=datetime-local]');
  d[0].value = 0
  d[1].value = 0
    document.getElementById("message").textContent="Status Change Time Set Successful";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
}
else if(data=="Not Found"){
  
  document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent="Form not found";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
} 
            if (response) {
         
              return response; // Assuming your script returns JSON response
            } else {
              throw new Error("Failed to load the form.");
            }
          })
    /*      .then(async function (data) {
            const result1 = await data.json();
            console.log(result1.data2);
            var data = result1.data2;
if(data=="Success"){
  document.getElementById("loader").style.display="none"; 
  const d =   document.querySelectorAll('input[type=datetime-local]');
  d[0].value = 0
  d[1].value = 0
    document.getElementById("message").textContent="Status Change Time Set Successful";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
}
else if(data=="Not Found"){
  
  document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent="Form not found";
    setTimeout(function () { document.getElementById("load").style.display="none"; 
    ustatus="";
    },2000);
} 
})*/

          .catch(function (error) {
            // Handle errors, you can display an error message here
            console.error(error);
            document.getElementById("message").textContent =
              "An error occurred while set the time.";
            document.getElementById("message").style.display = "block";
          });
    }
    function formactive(formname){
      ustatus="Going";
   
     var type =  document.querySelector('input[name="Type of Active Status Change"]:checked').value;
     if(type=="Immediately"){
      var userac = getSelectedValues();
      updatestatus(formname,"Live",userac);
     }
     else if(type=="Set Time and Date"){
      var rawtime = document.getElementById("setactive time").value;
      console.log(rawtime);
      //var time = formatDate(rawtime);
      //console.log(time);
      var userac = getSelectedValues();
      timeupdatestatus(formname,"Live",rawtime,userac);
     }
    }
    function forminactive(formname){
      ustatus="Going";
    
     var type =  document.querySelector('input[name="Type of Inactive Status Change"]:checked').value;
     if(type=="Immediately"){
      updatestatus(formname,"Inactive","");
     }
     else if(type=="Set Time and Date"){
      var rawtime = document.getElementById("setinactive time").value;
      console.log(rawtime);
      //var time = formatDate(rawtime);
      //console.log(time);
      timeupdatestatus(formname,"Inactive",rawtime,"");
     }
    }
   </script>
   <script>
    function formatDate(date) {
      console.log(date)
      date = new Date(date);
      console.log(date)
  var hours = date.getHours();
  var minutes = date.getMinutes();
  console.log(hours)

  minutes = minutes < 10 ? '0'+minutes : minutes;
  var strTime = hours + ':' + minutes;
  var month =date.getMonth();
  var exmonth = month+1;
  return (date.getDate()+ "-" +  exmonth)  + "-" + date.getFullYear() + "  " + strTime;
}
function formatDateto() {
      
      date = new Date();
      console.log(date)
  var hours = date.getHours();
  var minutes = date.getMinutes();

  console.log(hours)

  minutes = minutes < 10 ? '0'+minutes : minutes;
  if(hours<9){
    var strTime = "0"+hours + ':' + minutes;
  }
  else{
    var strTime = hours + ':' + minutes;
  }

  var month =date.getMonth();
  var exmonth = month+1;
  return (date.getFullYear()+ "-" +  exmonth)  + "-" + date.getDate() + "T" + strTime;
}
setInterval(() => {

  fetchd ();
  
}, 1000)
   </script>
   <script>
    function updatelogstatus(status){
      var updatestring = localStorage.getItem("loggedname")+"/"+status;
 
           
       fetch(
    
    "https://script.google.com/macros/s/AKfycbxEoNGPxEXxwtSXqRvPhgGK_btTmbVO4Tq6ZW002Q7Olap6cyoi5hmNAwYTS3OfLJCLug/exec",
    {
      redirect: "follow",
      method: "POST",
      body: updatestring,
      headers: {
        "Content-Type": "text/plain;charset=utf-8",
      },
    }
   )
   
    .then(function (response) {
   
      // Check if the request was successful
      if (response) {
   
        return response; // Assuming your script returns JSON response
      } else {
        throw new Error("Failed to fetch.");
      }
    })
    .then(async function (data) {
   const result1 = await data.json();
   
   var r = result1.data2;
  
   
   })
   
   .catch(function (error) {
   // Handle errors, you can display an error message here
   console.error(error);

   });
   }
   setInterval(() => {

fetchd ();
}, 1000)

setTimeout(() => {

updatelogstatus("Online");

}, 2000)
window.addEventListener("blur", () => {
  updatelogstatus("Offline");   
  });
  window.addEventListener("focus", () => {
  updatelogstatus("Online");   
  });
//window.unblur = colse();
const beforeUnloadHandler = (event) => {  
  updatelogstatus("Offline");  
};
window.addEventListener("beforeunload", beforeUnloadHandler);
   </script>
   <script>
    // JavaScript to handle the dropdown behavior and collect selected values
    function sel() {
      var dropdown = document.querySelector('.dropdown-content');
      if (dropdown.style.display !== 'none') {
        dropdown.style.display = 'none';
      }
      else{
        dropdown.style.display = 'initial';
      }
    }
    function dsel() {
      var dropdown = document.querySelector('.dropdown-content');
      if (dropdown.style.display !== 'none') {
        dropdown.style.display = 'none';
      }
     
    }
    
    function getSelectedValues() {
      var checkboxes = document.querySelectorAll('.dropdown-content input[type="checkbox"]');
      var selectedValues = [];
  
  console.log(checkboxes)
      var users =checkboxes[0].parentElement.parentElement.children;
      console.log(users)
      if (checkboxes[0].parentElement.parentElement.children[0].children[0].checked){
        for(var g= 2;g<users.length;g++){
          
          if (users[g].textContent.includes("M.Tech")){
          
            users[g].style.display="none";
            users[g].children[0].checked=false;
          }
        }
      }
  
    else  if (checkboxes[0].parentElement.parentElement.children[0].children[0].checked==false){
        for(var g= 2;g<users.length;g++){
          
          if (users[g].textContent.includes("M.Tech")){
          
            users[g].style.display="flex"
          }
        }
      }
     if (checkboxes[0].parentElement.parentElement.children[1].children[0].checked){
        for(var g= 2;g<users.length;g++){
          
          if (users[g].textContent.includes("B.Tech")){
          
            users[g].style.display="none";
            users[g].children[0].checked=false;
          }
        }
      }
      else  if (checkboxes[0].parentElement.parentElement.children[1].children[0].checked==false){
        for(var g= 2;g<users.length;g++){
          
          if (users[g].textContent.includes("B.Tech")){
          
            users[g].style.display="flex"
          }
        }
      }
      checkboxes.forEach(function(checkbox) {
        if (checkbox.checked) {
          selectedValues.push(checkbox.value);
        }
      });
      var values = selectedValues.join(", ")
      checkboxes[0].parentElement.parentElement.parentElement.children[1].children[0].value = values;
      return values;
    }
    
    </script>
</html>