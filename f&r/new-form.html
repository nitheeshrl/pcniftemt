<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>New Form</title>
  <link rel="stylesheet" href="style 3.css">
  <script type="text/javascript" src="app.js" defer></script>
  <link rel="icon" href="white_logo.png" type="image/x-icon">
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" href="style 1.css" />
  <link rel="stylesheet" type="text/css" href="style 2.css">
  <link rel="stylesheet" type="text/css" href="style 4.css">
 <style>
    table .approve{
       border-radius: 20px;
       padding: 10px;
       color: white;
       font-weight: bolder;
background-color: green;
margin-right: 20px;
text-decoration: none;
cursor: pointer;
}
table .decline{
border-radius: 20px;
padding: 10px;
color: white;
font-weight: bolder;
background-color: red;
margin-right: 20px;
text-decoration: none;
cursor: pointer;
}
.tablebee{
display: none;
}
.btn{
background-color:#182d8b;
margin-right: 20px;
text-decoration: none;
color: white;
border-radius: 20px;
padding: 20px;
cursor: pointer;
}
.btn1{
background-color:#182d8b;
height: 40px;
text-decoration: none;
color: white;
border-radius: 20px;
padding:12px;
cursor: pointer;
font-weight: bold;
}

</style>
<script type="text/javascript">
  function singleres(button){
  if (button.checked){
    button.parentElement.parentElement.nextElementSibling.children[0].style.display="initial";
    button.parentElement.parentElement.nextElementSibling.children[0].checked = true;
  }
  else{
    button.parentElement.parentElement.nextElementSibling.children[0].style.display="none";
    button.parentElement.parentElement.nextElementSibling.children[0].checked = false;
  }
}
  function getresoptions(){
  var formDataString0 = document.getElementsByName("Question");
  var optionsadd ="";
  var optionname11 = [];
    for(var i=0;i<formDataString0.length;i++){
  var optionname = formDataString0[i].value;
    optionname11[i] = formDataString0[i].value;

   var optiontemp =`
<option value='`+optionname+`'>`+optionname+`</option>
`;
optionsadd += optiontemp;
}
document.getElementById("Single Response Field").innerHTML=`<option value="">Select the field for single response</option>`+optionsadd;
return optionname11
}
     function gethtmldata(){
      console.log("Saving")
      
      var formname = document.getElementById("Form Name").value;
var formdescrip = document.getElementById("Form Description").innerHTML;
      var formDataString0 = document.getElementsByName("Question");
        var formDataString1 = document.getElementsByName("Question Type");
        var formDataString2 = document.getElementsByName("Question Description");
        var formDataString3 = document.getElementsByName("Question Required");
        var singleresponse = document.getElementById("Single Response Field").value;
        var html =[];
        html [0] =formname;
        html [1] =formdescrip;
        html [2] =singleresponse;

        for (var i=0;i<formDataString0.length;i++){
          var inhtml = [];
          inhtml[0] = formDataString0[i].value;
          inhtml[1] = formDataString1[i].value;
          inhtml[2] = formDataString2[i].innerHTML;
          inhtml[3] = formDataString3[i].value;
if (formDataString1[i].value =="Options"||formDataString1[i].value =="Multiple Select"||formDataString1[i].value =="Dropdown"){
  var optionsq =  formDataString0[i].parentElement.parentElement.parentElement.nextElementSibling.getElementsByClassName("Question-Option");
var optionsadd =[];
    for(var k=0;k<optionsq.length;k++){
  optionsadd [k] = optionsq[k].value;
    }
  inhtml[4] = optionsadd;
  inhtml[5] = "";
}
else if (formDataString1[i].value=="File Upload"){
  inhtml[4] = formDataString0[i].parentElement.parentElement.parentElement.parentElement.children[1].children[1].children[0].value;
  inhtml[5] = formDataString0[i].className;
}
else{
  inhtml[4] = "";
  inhtml[5] = "";
}
html[i+3]=inhtml
        }
        var jhtml = JSON.stringify(html)
        sessionStorage.setItem("backuphtml",jhtml);
       return html
    }
  function dis_span(button){

button.previousElementSibling.focus()
  }
  function en_span(button){
    console.log("f")
var val = button.textContent;
if (val==""){
  button.nextElementSibling.style.display="initial"
}
else{
  button.nextElementSibling.style.display="none"
}
gethtmldata()
  }
  function getSelectionText() {
    let text = "";
    const activeEl = document.activeElement;
    const activeElTagName = activeEl ? activeEl.tagName.toLowerCase() : null;

    if (
      (activeElTagName == "textarea") || (activeElTagName == "input" &&
      /^(?:text|search|password|tel|url)$/i.test(activeEl.type)) &&
      (typeof activeEl.selectionStart == "number")
    ) {
        text = activeEl.value.slice(activeEl.selectionStart, activeEl.selectionEnd);
    } else if (window.getSelection) {
        text = window.getSelection().toString();
    }

    return text;
}
document.onmouseup = document.onkeyup = document.onselectionchange = function() {
  sessionStorage.setItem("selvalueofinput",getSelectionText());
  var selval = sessionStorage.getItem("selvalueofinput");
  console.log(selval);
};
function boldtxt(button){

  var selval = sessionStorage.getItem("selvalueofinput");
 
var indiv = button.parentElement.previousElementSibling.children[0].innerHTML;
var newva = '<b>'+selval+"</b>";

var fcheck = indiv.replace(newva,"");
console.log(indiv.length!==fcheck.length)
if (indiv.includes(newva)){
  var fvalue = indiv.replace(newva,selval);
}
else{
  var fvalue = indiv.replace(selval,newva);
}


button.parentElement.previousElementSibling.children[0].innerHTML = fvalue
console.log(indiv,newva)
gethtmldata()
}
function italicstxt(button){

var selval = sessionStorage.getItem("selvalueofinput");

var indiv = button.parentElement.previousElementSibling.children[0].innerHTML;
var newva = '<i>'+selval+"</i>";

var fcheck = indiv.replace(newva,"");
console.log(indiv.length!==fcheck.length)
if (indiv.includes(newva)){
var fvalue = indiv.replace(newva,selval);
}
else{
var fvalue = indiv.replace(selval,newva);
}


button.parentElement.previousElementSibling.children[0].innerHTML = fvalue
console.log(indiv,newva)
gethtmldata()
}
function underlinetxt(button){

var selval = sessionStorage.getItem("selvalueofinput");

var indiv = button.parentElement.previousElementSibling.children[0].innerHTML;
var newva = '<u>'+selval+"</u>";

var fcheck = indiv.replace(newva,"");
console.log(indiv.length!==fcheck.length)
if (indiv.includes(newva)){
var fvalue = indiv.replace(newva,selval);
}
else{
var fvalue = indiv.replace(selval,newva);
}


button.parentElement.previousElementSibling.children[0].innerHTML = fvalue
console.log(indiv,newva)
gethtmldata()
}

  function swapSibling(now,pre) {
    console.log("jj")
   
   now.parentNode.insertBefore(now,pre)


  }
  function divup(button){
var present = button.parentElement.parentElement.parentElement.parentElement;
var before = button.parentElement.parentElement.parentElement.parentElement.previousElementSibling;
console.log(before)

if (before!==null){
  swapSibling(present,before)
}
  }
  function divdown(button){
var present = button.parentElement.parentElement.parentElement.parentElement;
var next = button.parentElement.parentElement.parentElement.parentElement.nextElementSibling;

if (next!==null){
  swapSibling(next,present)
}
  }
  function logout(){
    updatelogstatus("Offline");  
    localStorage.removeItem("loggedname")
    window.location="../logout.html";
  }
  function userPopup(){
        console.log("ok")
document.getElementById("popup-4").classList.toggle("active");
}
function logoutPopup(){
        console.log("ok")
document.getElementById("popup-3").classList.toggle("active");

}
function togglePopup3(){
   document.getElementById("popup-3").classList.toggle("active");
   }
</script>
</head>
<body>
  <nav id="sidebar">
    <ul>
      <li class="indetails" id="insname">
        <div style="width: 50px; display: flex;gap: 10px;">
          <img style="width: 50px;" src="white_logo.png" alt="">
          <span style="color: white;">NIFTEM-T <br> Placement Cell</span>
        </div>
        
        <button onclick=toggleSidebar() id="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z"/></svg>
        </button>
      </li>
      <li class="outdetails" id="outlogo" style="">
        <button class="out-items" onclick=toggleSidebar1() id="toggle-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z"/></svg>
        </button>
        <img class="out-items" style="width: 50px;" src="white_logo.png" alt="">
        <img id="profileimage1" style=" scale:90%;border-radius: 50px; width: 50px; height: 50px; " src=".//1.png" alt="" srcset="">
       
      </li>
      <li class="indetails"  id="insprofile" style="left: 0px;">
        <div class="log-items" style="flex-direction: column; gap: 0px; align-items: center;justify-content: center;">
         <a onclick="userPopup()"><img id="profileimage" style=" scale:200%;border-radius: 50px; width: 50px; height: 50px; " src=".//1.png" alt="" srcset=""></a>
       <div style="background-color: white; color: black; padding: 10px;border-radius: 40px;">
        <p ><span id="mname">Nitheesh R L</span></p>
       </div>
       

          </div>

      </li>
      <li>
        <a  onclick="notavailable()">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M520-640v-160q0-17 11.5-28.5T560-840h240q17 0 28.5 11.5T840-800v160q0 17-11.5 28.5T800-600H560q-17 0-28.5-11.5T520-640ZM120-480v-320q0-17 11.5-28.5T160-840h240q17 0 28.5 11.5T440-800v320q0 17-11.5 28.5T400-440H160q-17 0-28.5-11.5T120-480Zm400 320v-320q0-17 11.5-28.5T560-520h240q17 0 28.5 11.5T840-480v320q0 17-11.5 28.5T800-120H560q-17 0-28.5-11.5T520-160Zm-400 0v-160q0-17 11.5-28.5T160-360h240q17 0 28.5 11.5T440-320v160q0 17-11.5 28.5T400-120H160q-17 0-28.5-11.5T120-160Zm80-360h160v-240H200v240Zm400 320h160v-240H600v240Zm0-480h160v-80H600v80ZM200-200h160v-80H200v80Zm160-320Zm240-160Zm0 240ZM360-280Z"/></svg>
          <span>Dashboard</span>
        </a>
      </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h207q16 0 30.5 6t25.5 17l57 57h320q33 0 56.5 23.5T880-640v400q0 33-23.5 56.5T800-160H160Zm0-80h640v-400H447l-80-80H160v480Zm0 0v-480 480Zm400-160v40q0 17 11.5 28.5T600-320q17 0 28.5-11.5T640-360v-40h40q17 0 28.5-11.5T720-440q0-17-11.5-28.5T680-480h-40v-40q0-17-11.5-28.5T600-560q-17 0-28.5 11.5T560-520v40h-40q-17 0-28.5 11.5T480-440q0 17 11.5 28.5T520-400h40Z"/></svg>
          <span>Brochure Update</span>
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu">
          <div>
           
            <li><a href="index.html">Active Requests</a></li>
            <li><a href="past.html">Past Requests</a></li>
            <li><a  target="_blank" href="user.html">Request Form</a></li>
          </div>
        </ul>
      </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m221-313 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-228q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm0-320 142-142q12-12 28-11.5t28 12.5q11 12 11 28t-11 28L250-548q-12 12-28 12t-28-12l-86-86q-11-11-11-28t11-28q11-11 28-11t28 11l57 57Zm339 353q-17 0-28.5-11.5T520-320q0-17 11.5-28.5T560-360h280q17 0 28.5 11.5T880-320q0 17-11.5 28.5T840-280H560Zm0-320q-17 0-28.5-11.5T520-640q0-17 11.5-28.5T560-680h280q17 0 28.5 11.5T880-640q0 17-11.5 28.5T840-600H560Z"/></svg>
          <span>Forms</span>
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu show">
          <div>
            <li><a href="new-placement-form.html">New Placement Form</a></li>
            <li><a  href="past-placement-forms.html">Old Placement Forms</a></li>
            <li class="active"><a href="new-form.html">New Form</a></li>
            <li><a  href="past-forms.html">Old Forms</a></li>
          </div>
        </ul>
      </li>
      <li>
        <button onclick=toggleSubMenu(this) class="dropdown-btn">
          
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-240v-32q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v32q0 33-23.5 56.5T720-160H240q-33 0-56.5-23.5T160-240Zm80 0h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z"/></svg>
          <span>Profile</span>
 
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"/></svg>
        </button>
        <ul class="sub-menu ">
          <div>
            <li><a href="change-pass-1.html">Change Password</a></li>
            <li><a onclick="passkey()">Create PassKey</a></li>
            <li><a onclick="logoutPopup()" >Logout</a></li>
          </div>
        </ul>
      </li>

    </ul>
  </nav>
  <main style="width: 100%;">
<div class="container" style="width: 100%;margin-left: 0px;" onclick="closeAllSubMenus()">
<section id ="placeform">
  <div style="width: 100%;" class="form-container" >
    <script type="text/javascript">var submitted=false </script>
    <iframe name="hiddenConfirm" id="hiddenConfirm" style="display: none;" onload="if(submitted){
        window.location='submifssion.html'; }"></iframe>
        <form style="width: 100%;" id="form" class="container m-4 pl-4" method="POST" onchange="gethtmldata()">
    <h1 style="text-align: center;"> New Form </h1><br>
    <div id="formdetails">
    <div class="form-element">
    <span class="q">Form Name</span>
    <input type="text" name="Form Name" id="Form Name" required placeholder="Enter the Form Name" value="" />
    </div><br>
    <div class="form-element" style="width: 100%;">
        <span class="q">Form Description</span>  
        <div style="display: flex;flex-direction: column;min-height: 60px; height: 100%;">
  <span oninput="en_span(this)"  style="width: 100%;" class="input-span" contenteditable="true" name="Form Description" id="Form Description"></span>
  <span onclick="dis_span(this)"  class="span-in-place" style="width: 100%;">Enter the Form Description</span>
</div>
  <div style="margin-top: 20px;margin-bottom: -30px;" class="edit-btns">
      <button onclick="boldtxt(this)" type="button" style="background: none;width: 50px;margin-top: -30px;">
        <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M2 1H8.625C11.0412 1 13 2.95875 13 5.375C13 6.08661 12.8301 6.75853 12.5287 7.35243C13.4313 8.15386 14 9.32301 14 10.625C14 13.0412 12.0412 15 9.625 15H2V1ZM5.5 9.75V11.5H9.625C10.1082 11.5 10.5 11.1082 10.5 10.625C10.5 10.1418 10.1082 9.75 9.625 9.75H5.5ZM5.5 6.25H8.625C9.10825 6.25 9.5 5.85825 9.5 5.375C9.5 4.89175 9.10825 4.5 8.625 4.5H5.5V6.25Z" fill="#0042aa"></path> </g></svg>
    </button>
    <button onclick="italicstxt(this)" type="button" style="background: none;width: 50px;margin-top: -30px;">
      <svg fill="#0042aa" height="16px" width="20px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 306.001 306.001" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M249.142,0H120.713c-4.142,0-7.5,3.358-7.5,7.5s3.358,7.5,7.5,7.5h54.958l-58.527,276H56.859c-4.142,0-7.5,3.358-7.5,7.5 s3.358,7.5,7.5,7.5h66.339c0.009,0,0.019,0.001,0.028,0.001c0.006,0,0.011-0.001,0.017-0.001h62.044c4.142,0,7.5-3.358,7.5-7.5 s-3.358-7.5-7.5-7.5h-52.811l58.527-276h58.138c4.142,0,7.5-3.358,7.5-7.5S253.284,0,249.142,0z"></path> </g></svg>
    </button>
    <button onclick="underlinetxt(this)" type="button" style="background: none;width: 50px;margin-top: -30px;">
      <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M4 21H20M18 4V11C18 14.3137 15.3137 17 12 17C8.68629 17 6 14.3137 6 11V4M4 3H8M16 3H20" stroke="#0056d6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
    </button>
      </div>
    </div>
    <div style="display: flex;flex-direction: column;">
    <div class="form-element radio-buttons" style="width: 47%;margin-top: 10px;">
    <label for="Enable Single Response">
<input
type="checkbox"
name="Question Enable Single Response" 
value="Enable Single Response"
id="Single Response Field Check"
onchange="singleres(this)"
/>
<span>Enable Single Response</span>
</label>
    </div>
    <div class="form-element-response" style="width: 50%;margin-top: -30px;margin-bottom: 20px;margin-left: 40px;">
      <select style="display: none;" id="Single Response Field" name="Single Response Field" value="">
      <option value="">Select the field for single response</option>
      </select>
    </div>
  </div>
    <span><b>Questions need to be in the form</b></span><br><br>
    <div id="question-area" class="question-area" onchange="getresoptions()">
      <div class="question-no">
    <div class="question-name">
      <span>Question</span>
    <div class="question-select">
    <div class="form-element">
    <input style="margin-top: 0px;" type="text" name="Question" required placeholder="Enter the Question"/>


    </div>

    <div class="form-element">
      <select name="Question Type" required onchange="addqoptions(this)" value="">
      <option value="">Select the type of question</option>
      <option value='Short Answer'>Short Answer</option>
      <option value='Long Answer'>Long Answer</option>
      <option value='Options'>Options</option>
      <option value='Multiple Select'>Multiple Select</option>
      <option value='Dropdown'>Dropdown</option>
      <option value='Checkbox'>Checkbox</option>
      <option value='File Upload'>File Upload</option>
      <option value='Time'>Time</option>
      <option value='Date'>Date</option>
      <option value='Time and Date'>Time and Date</option>
      </select>
    </div>
  <div style="display: flex;width: 120px;">
    <button onclick="removequestion(this)" type="button" style="background: none;width: 50px;margin-top: -30px;">
      <svg fill="#0042aa" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 41.756 41.756" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M27.948,20.878L40.291,8.536c1.953-1.953,1.953-5.119,0-7.071c-1.951-1.952-5.119-1.952-7.07,0L20.878,13.809L8.535,1.465 c-1.951-1.952-5.119-1.952-7.07,0c-1.953,1.953-1.953,5.119,0,7.071l12.342,12.342L1.465,33.22c-1.953,1.953-1.953,5.119,0,7.071 C2.44,41.268,3.721,41.755,5,41.755c1.278,0,2.56-0.487,3.535-1.464l12.343-12.342l12.343,12.343 c0.976,0.977,2.256,1.464,3.535,1.464s2.56-0.487,3.535-1.464c1.953-1.953,1.953-5.119,0-7.071L27.948,20.878z"></path> </g> </g></svg>
    </button>
    <button onclick="divup(this)" type="button" style="background: none;width: 50px;margin-top: -30px;">
      <svg fill="#0042aa" height="20px" width="20px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 330 330" xml:space="preserve" stroke="#0042aa"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path id="XMLID_224_" d="M325.606,229.393l-150.004-150C172.79,76.58,168.974,75,164.996,75c-3.979,0-7.794,1.581-10.607,4.394 l-149.996,150c-5.858,5.858-5.858,15.355,0,21.213c5.857,5.857,15.355,5.858,21.213,0l139.39-139.393l139.397,139.393 C307.322,253.536,311.161,255,315,255c3.839,0,7.678-1.464,10.607-4.394C331.464,244.748,331.464,235.251,325.606,229.393z"></path> </g></svg>
    </button>
    <button onclick="divdown(this)" type="button" style="background: none;width: 50px;margin-top: -30px;">
      <svg fill="#0042aa" height="20px" width="20px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 330 330" xml:space="preserve" stroke="#0042aa"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path id="XMLID_225_" d="M325.607,79.393c-5.857-5.857-15.355-5.858-21.213,0.001l-139.39,139.393L25.607,79.393 c-5.857-5.857-15.355-5.858-21.213,0.001c-5.858,5.858-5.858,15.355,0,21.213l150.004,150c2.813,2.813,6.628,4.393,10.606,4.393 s7.794-1.581,10.606-4.394l149.996-150C331.465,94.749,331.465,85.251,325.607,79.393z"></path> </g></svg>
    </button>
  </div>
  </div>
  <div style="display: flex;justify-content: space-between;">
    <div class="form-element" style="width: 47%;margin-bottom: 0px;">
      <div style="display: flex;flex-direction: column;min-height: 55px; height:calc(100% - 50px) ;">
      <span oninput="en_span(this)"  style="font-weight: lighter;" class="input-span" contenteditable="true" name="Question Description" ></span>
      <span onclick="dis_span(this)" style="font-weight: lighter;" class="span-in-place" >Question Description</span>
    </div>
      <div  class="edit-btns">
      <button onclick="boldtxt(this)" type="button" style="background: none; width: 50px;">
        <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M2 1H8.625C11.0412 1 13 2.95875 13 5.375C13 6.08661 12.8301 6.75853 12.5287 7.35243C13.4313 8.15386 14 9.32301 14 10.625C14 13.0412 12.0412 15 9.625 15H2V1ZM5.5 9.75V11.5H9.625C10.1082 11.5 10.5 11.1082 10.5 10.625C10.5 10.1418 10.1082 9.75 9.625 9.75H5.5ZM5.5 6.25H8.625C9.10825 6.25 9.5 5.85825 9.5 5.375C9.5 4.89175 9.10825 4.5 8.625 4.5H5.5V6.25Z" fill="#0042aa"></path> </g></svg>
    </button>
    <button onclick="italicstxt(this)" type="button" style="background: none;width: 50px;">
      <svg fill="#0042aa" height="16px" width="20px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 306.001 306.001" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M249.142,0H120.713c-4.142,0-7.5,3.358-7.5,7.5s3.358,7.5,7.5,7.5h54.958l-58.527,276H56.859c-4.142,0-7.5,3.358-7.5,7.5 s3.358,7.5,7.5,7.5h66.339c0.009,0,0.019,0.001,0.028,0.001c0.006,0,0.011-0.001,0.017-0.001h62.044c4.142,0,7.5-3.358,7.5-7.5 s-3.358-7.5-7.5-7.5h-52.811l58.527-276h58.138c4.142,0,7.5-3.358,7.5-7.5S253.284,0,249.142,0z"></path> </g></svg>
    </button>
    <button onclick="underlinetxt(this)" type="button" style="background: none;width: 50px;">
      <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M4 21H20M18 4V11C18 14.3137 15.3137 17 12 17C8.68629 17 6 14.3137 6 11V4M4 3H8M16 3H20" stroke="#0056d6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
    </button>
      </div>
    </div>

    <div class="form-element radio-buttons" style="width: 47%;margin-top: 10px;">
    <label for="Required">
<input
type="checkbox"
name="Question Required" 
value="Required"
/>
<span>Required</span>
</label>
    </div>

    </div>

</div>

  </div>
    </div>
    <div style="display: flex;align-items: center;justify-content: center;">
  <button onclick="addquestion()" type="button" style="background: none;width: 40px;">
    <svg fill="#0042aa" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 45.402 45.402" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141 c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27 c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435 c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z"></path> </g> </g></svg>
    </button>
 
    </div>
    <button style="margin-top: 20px;margin-bottom: 40px;" type="submit" id="bt"> 
    Create Form
    </button> 
  </div>
    <div id="load" class="load" > 
      <div class="loader" id="loader"> 
    
        </div> 
        <div
          id="message"
        class="message"
          ></div>
      </div> 
      </form>
      </div> 
    </section>
    <section class="msg" id="msg" style="display: none;flex-direction: column; align-items: center;justify-content: center;height: 100vh;">
<h1>Successfully Created</h1><br>
<p style="color: black;text-align: center;">Thank for creating your form <br>
<span  id="finallink"></span></p>
</section>
</div>
    </main>
    <div id="load" class="load" > 
        <div class="loader" id="loader"> 
      
          </div> 
          <div
            id="message"
          class="message"
          style="width: 350px;"
            ></div>
        </div>      
        <div class="popup1" id="popup-3">
 
          <div class="overlay"></div>
      
          <div class="content">
      
          <div class="close-btn" onclick="togglePopup3()">&times;</div>
      
          <h1 style="margin-top: 50px;">Are you sure to logout?</h1>
      
          <p style="margin-bottom: 40px;"> </p>
          <div >
              <input id="aid" type="hidden" value="">
      <a class="btn" id="apbt" onclick="logout()">Yes</a>
      <a class="btn" onclick="togglePopup3()">Cancel</a>
          </div>
          </div>
      
          </div>
          <div class="popup" id="popup-1">
 
            <div class="overlay"></div>
        
            <div class="content">
        
            <div class="close-btn" onclick="togglePopup()">&times;</div>
        
            <h1 style="margin-top: 50px;">Confirm Update Approval</h1>
        
            <p style="margin-bottom: 40px;">Are you sure you wish to approve the Brochure details update? </p>
            <div >
                <input id="aid" type="hidden" value="">
        <a class="btn" id="apbt" onclick="approve()">Confirm</a>
        <a class="btn" onclick="togglePopup()">Cancel</a>
            </div>
            </div>
        
            </div>
      <div class="popup" id="popup-2">
  
          <div class="overlay"></div>
      
          <div class="content" style="height:400px;">
      
          <div class="close-btn" onclick="togglePopup2()">&times;</div>
      
          <h1 style="margin-top: 50px;">Confirm Update Decline</h1>
      
          <p style="margin-bottom: 40px;">Are you sure you wish to decline the Brochure details update? </p>
          <div >
              <div class="form-element" style=" flex-direction: column;align-items: flex-start; width: 100%;margin-bottom: 40px;">
                  <span class="q" >Reason for decline</span>
                  <input type="text" name="Reason" id="Reason" style="width: 100%;" placeholder="Enter the reason" />
                  </div>
                  <input id="did" type="hidden" value="">
      <a class="btn" id="decbt" onclick="decline()" style="background-color: red;">Decline</a>
      <a class="btn" onclick="togglePopup2()">Cancel</a>
          </div>
          </div>
      
          </div>
    </div>


  </div>
  </main>
  
</body>
<script src="https://unpkg.com/@simplewebauthn/browser/dist/bundle/index.umd.min.js"></script>
<script>
  var porfilepicback = sessionStorage.getItem("backprofilepic");
  if (porfilepicback!==null){
    document.getElementById("profileimage").src = porfilepicback;
    document.getElementById("profileimage1").src = porfilepicback;
  }
  var crestatus = "";
  function addquestion(){
var newitem = 
`
  <div class="question-no">
    <div class="question-name">
      <span>Question</span>
    <div class="question-select">
    <div class="form-element">
    <input style="margin-top: 0px;" type="text" name="Question" required placeholder="Enter the Question"/>


    </div>

    <div class="form-element">
      <select name="Question Type" required onchange="addqoptions(this)" value="">
      <option value="">Select the type of question</option>
      <option value='Short Answer'>Short Answer</option>
      <option value='Long Answer'>Long Answer</option>
      <option value='Options'>Options</option>
      <option value='Multiple Select'>Multiple Select</option>
      <option value='Dropdown'>Dropdown</option>
      <option value='Checkbox'>Checkbox</option>
      <option value='File Upload'>File Upload</option>
      <option value='Time'>Time</option>
      <option value='Date'>Date</option>
      <option value='Time and Date'>Time and Date</option>
      </select>
    </div>
  <div style="display: flex;width: 120px;">
    <button onclick="removequestion(this)" type="button" style="background: none;width: 50px;margin-top: -30px;">
      <svg fill="#0042aa" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 41.756 41.756" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M27.948,20.878L40.291,8.536c1.953-1.953,1.953-5.119,0-7.071c-1.951-1.952-5.119-1.952-7.07,0L20.878,13.809L8.535,1.465 c-1.951-1.952-5.119-1.952-7.07,0c-1.953,1.953-1.953,5.119,0,7.071l12.342,12.342L1.465,33.22c-1.953,1.953-1.953,5.119,0,7.071 C2.44,41.268,3.721,41.755,5,41.755c1.278,0,2.56-0.487,3.535-1.464l12.343-12.342l12.343,12.343 c0.976,0.977,2.256,1.464,3.535,1.464s2.56-0.487,3.535-1.464c1.953-1.953,1.953-5.119,0-7.071L27.948,20.878z"></path> </g> </g></svg>
    </button>
    <button onclick="divup(this)" type="button" style="background: none;width: 50px;margin-top: -30px;">
      <svg fill="#0042aa" height="20px" width="20px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 330 330" xml:space="preserve" stroke="#0042aa"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path id="XMLID_224_" d="M325.606,229.393l-150.004-150C172.79,76.58,168.974,75,164.996,75c-3.979,0-7.794,1.581-10.607,4.394 l-149.996,150c-5.858,5.858-5.858,15.355,0,21.213c5.857,5.857,15.355,5.858,21.213,0l139.39-139.393l139.397,139.393 C307.322,253.536,311.161,255,315,255c3.839,0,7.678-1.464,10.607-4.394C331.464,244.748,331.464,235.251,325.606,229.393z"></path> </g></svg>
    </button>
    <button onclick="divdown(this)" type="button" style="background: none;width: 50px;margin-top: -30px;">
      <svg fill="#0042aa" height="20px" width="20px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 330 330" xml:space="preserve" stroke="#0042aa"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path id="XMLID_225_" d="M325.607,79.393c-5.857-5.857-15.355-5.858-21.213,0.001l-139.39,139.393L25.607,79.393 c-5.857-5.857-15.355-5.858-21.213,0.001c-5.858,5.858-5.858,15.355,0,21.213l150.004,150c2.813,2.813,6.628,4.393,10.606,4.393 s7.794-1.581,10.606-4.394l149.996-150C331.465,94.749,331.465,85.251,325.607,79.393z"></path> </g></svg>
    </button>
  </div>
  </div>
  <div style="display: flex;justify-content: space-between;">
    <div class="form-element" style="width: 47%;margin-bottom: 0px;">
      <div style="display: flex;flex-direction: column;min-height: 55px; height:calc(100% - 50px) ;">
      <span oninput="en_span(this)"  style="font-weight: lighter;" class="input-span" contenteditable="true" name="Question Description" ></span>
      <span onclick="dis_span(this)" style="font-weight: lighter;" class="span-in-place" >Question Description</span>
    </div>
      <div  class="edit-btns">
      <button onclick="boldtxt(this)" type="button" style="background: none; width: 50px;">
        <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M2 1H8.625C11.0412 1 13 2.95875 13 5.375C13 6.08661 12.8301 6.75853 12.5287 7.35243C13.4313 8.15386 14 9.32301 14 10.625C14 13.0412 12.0412 15 9.625 15H2V1ZM5.5 9.75V11.5H9.625C10.1082 11.5 10.5 11.1082 10.5 10.625C10.5 10.1418 10.1082 9.75 9.625 9.75H5.5ZM5.5 6.25H8.625C9.10825 6.25 9.5 5.85825 9.5 5.375C9.5 4.89175 9.10825 4.5 8.625 4.5H5.5V6.25Z" fill="#0042aa"></path> </g></svg>
    </button>
    <button onclick="italicstxt(this)" type="button" style="background: none;width: 50px;">
      <svg fill="#0042aa" height="16px" width="20px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 306.001 306.001" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M249.142,0H120.713c-4.142,0-7.5,3.358-7.5,7.5s3.358,7.5,7.5,7.5h54.958l-58.527,276H56.859c-4.142,0-7.5,3.358-7.5,7.5 s3.358,7.5,7.5,7.5h66.339c0.009,0,0.019,0.001,0.028,0.001c0.006,0,0.011-0.001,0.017-0.001h62.044c4.142,0,7.5-3.358,7.5-7.5 s-3.358-7.5-7.5-7.5h-52.811l58.527-276h58.138c4.142,0,7.5-3.358,7.5-7.5S253.284,0,249.142,0z"></path> </g></svg>
    </button>
    <button onclick="underlinetxt(this)" type="button" style="background: none;width: 50px;">
      <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M4 21H20M18 4V11C18 14.3137 15.3137 17 12 17C8.68629 17 6 14.3137 6 11V4M4 3H8M16 3H20" stroke="#0056d6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
    </button>
      </div>
    </div>

    <div class="form-element radio-buttons" style="width: 47%;margin-top: 10px;">
    <label for="Required">
<input
type="checkbox"
name="Question Required" 
value="Required"
/>
<span>Required</span>
</label>
    </div>

    </div>

</div>

  </div>
`;

var qsection = document.getElementById("question-area").innerHTML;
var newsection = qsection + newitem;
var lastelement = document.getElementById("question-area").children;
var lastno = lastelement.length-1;
console.log(lastelement[lastno])
lastelement[lastno].insertAdjacentHTML("afterend",newitem) 

  }
  function removequestion(button){


    button.parentElement.parentElement.parentElement.parentElement.remove();
  }
  function addoption(button){
var newitem = 
`
<div class="question-select">
  <div class="form-element">
    <input type="text" class="Question-Option"  placeholder="Enter the Option"/>
    </div>
    <button onclick="removeoption(this)" type="button" style="background: none;width: 32px;margin-top: -30px;">
      <svg fill="#0042aa" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 41.756 41.756" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M27.948,20.878L40.291,8.536c1.953-1.953,1.953-5.119,0-7.071c-1.951-1.952-5.119-1.952-7.07,0L20.878,13.809L8.535,1.465 c-1.951-1.952-5.119-1.952-7.07,0c-1.953,1.953-1.953,5.119,0,7.071l12.342,12.342L1.465,33.22c-1.953,1.953-1.953,5.119,0,7.071 C2.44,41.268,3.721,41.755,5,41.755c1.278,0,2.56-0.487,3.535-1.464l12.343-12.342l12.343,12.343 c0.976,0.977,2.256,1.464,3.535,1.464s2.56-0.487,3.535-1.464c1.953-1.953,1.953-5.119,0-7.071L27.948,20.878z"></path> </g> </g></svg>
    </button>
  </div>
`;

var qsection = button.parentElement.previousElementSibling.innerHTML;

var newsection = qsection + newitem;

var newoption = button.parentElement.previousElementSibling.insertAdjacentHTML("afterend",newitem) 

return;
  }
  function removeoption(button){
  

    button.parentElement.remove();
  }
  function addqoptions(button){

console.log(button.parentElement.parentElement.parentElement.children)
if(button.parentElement.parentElement.parentElement.nextElementSibling==null){
    if(button.value =="Options"||button.value =="Multiple Select"||button.value =="Dropdown"){

var newitem = 
`
  <div class="question-options" style="width: 50%;">
    <span>Options</span>
 <div class="options-q" >
<div class="question-select">
  <div class="form-element">
    <input type="text" class="Question-Option"  placeholder="Enter the Option"/>
    </div>
    <button onclick="removeoption(this)" type="button" style="background: none;width: 32px;margin-top: -30px;">
      <svg fill="#0042aa" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 41.756 41.756" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M27.948,20.878L40.291,8.536c1.953-1.953,1.953-5.119,0-7.071c-1.951-1.952-5.119-1.952-7.07,0L20.878,13.809L8.535,1.465 c-1.951-1.952-5.119-1.952-7.07,0c-1.953,1.953-1.953,5.119,0,7.071l12.342,12.342L1.465,33.22c-1.953,1.953-1.953,5.119,0,7.071 C2.44,41.268,3.721,41.755,5,41.755c1.278,0,2.56-0.487,3.535-1.464l12.343-12.342l12.343,12.343 c0.976,0.977,2.256,1.464,3.535,1.464s2.56-0.487,3.535-1.464c1.953-1.953,1.953-5.119,0-7.071L27.948,20.878z"></path> </g> </g></svg>
    </button>
  </div>
</div>   
  <div style="display: flex;align-items: center;justify-content: center;">
  <button onclick="addoption(this)" type="button" style="background: none;width: 35px;margin-top: -20px;">
    <svg fill="#0042aa" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 45.402 45.402" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141 c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27 c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435 c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z"></path> </g> </g></svg>
    </button>

    </div>
            <div class="form-element" style="width:200%;">
<span class="q">Add options with csv</span>
<span>Upload file in csv, for template <a  target="_blank" download href="csv upload template.csv" >click here</a></span>
<input  type="file" accept=".csv" onclick="optionsupload(this)"/>
<input type="hidden" value=""/>
</div>
    </div>
    `;
    console.log(button)

    var qsection =  button.parentElement.parentElement.parentElement.innerHTML;
    var newsection = qsection + newitem; 
    button.parentElement.parentElement.parentElement.insertAdjacentHTML("afterend",newitem) 
    if(button.parentElement.parentElement.nextElementSibling.children[0].style.display=="none"){
button.parentElement.parentElement.nextElementSibling.children[0].style.display="initial"
    }
  }
  else if(button.value =="File Upload"){

    var newitem = 
`
<div class="question-support">
  <span>Select the files to support</span>
  <div class="form-element radio-buttons" style="width: 47%;margin-top: 10px;display: flex;flex-direction: row;">
    <input type="hidden" >
    <label for="PDF">
<input
onchange="checkboxvalue(this)"
type="checkbox"
value=".PDF,.pdf"
/>

</label>
<span>PDF</span>
<label for="JPG">
<input
onchange="checkboxvalue(this)"
type="checkbox"
value=".JPG,.jpg,.JPEG,.jpeg"
/>

</label>
<span>JPG</span>
<label for="PNG">
<input
onchange="checkboxvalue(this)"
type="checkbox" 
value=".PNG,.png"
/>

</label>
<span>PNG</span>
<label for="PPT">
<input
onchange="checkboxvalue(this)"
type="checkbox" 
value=".ppt,.pptx"
/>

</label>
<span>PPT</span>
<label for="Doc">
<input
onchange="checkboxvalue(this)"
type="checkbox" 
value=".doc,.docx"
/>

</label>
<span>Doc</span>
    </div>
  </div>
    `;
    var qsection =  button.parentElement.parentElement.parentElement.innerHTML;
    var newsection = qsection + newitem; 
    button.parentElement.parentElement.parentElement.insertAdjacentHTML("afterend",newitem) 
    if(button.parentElement.parentElement.nextElementSibling.children[0].style.display=="none"){
button.parentElement.parentElement.nextElementSibling.children[0].style.display="initial"
    }
  }
  else if(button.value =="Checkbox"){
    console.log(button.value)
    button.parentElement.parentElement.nextElementSibling.children[0].style.display="none"
  }
  else{
    if(button.parentElement.parentElement.nextElementSibling.children[0].style.display=="none"){
button.parentElement.parentElement.nextElementSibling.children[0].style.display="initial"
    }
  }

  }
  else if(button.parentElement.parentElement.parentElement.nextElementSibling!==null){
    if(button.value =="Options"||button.value =="Multiple Select"||button.value =="File Upload"||button.value =="Dropdown"){
      if(button.value =="Options"||button.value =="Multiple Select"||button.value =="Dropdown"){
        if(button.parentElement.parentElement.parentElement.nextElementSibling.className!=="question-options"){
          button.parentElement.parentElement.parentElement.nextElementSibling.remove();
          var newitem = 
`
  <div class="question-options" style="width: 50%;">
    <span>Options</span>
 <div class="options-q" >
<div class="question-select">
  <div class="form-element">
    <input type="text" class="Question-Option"  placeholder="Enter the Option"/>
    </div>
    <button onclick="removeoption(this)" type="button" style="background: none;width: 32px;margin-top: -30px;">
      <svg fill="#0042aa" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 41.756 41.756" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M27.948,20.878L40.291,8.536c1.953-1.953,1.953-5.119,0-7.071c-1.951-1.952-5.119-1.952-7.07,0L20.878,13.809L8.535,1.465 c-1.951-1.952-5.119-1.952-7.07,0c-1.953,1.953-1.953,5.119,0,7.071l12.342,12.342L1.465,33.22c-1.953,1.953-1.953,5.119,0,7.071 C2.44,41.268,3.721,41.755,5,41.755c1.278,0,2.56-0.487,3.535-1.464l12.343-12.342l12.343,12.343 c0.976,0.977,2.256,1.464,3.535,1.464s2.56-0.487,3.535-1.464c1.953-1.953,1.953-5.119,0-7.071L27.948,20.878z"></path> </g> </g></svg>
    </button>
  </div>
</div>   
  <div style="display: flex;align-items: center;justify-content: center;">
  <button onclick="addoption(this)" type="button" style="background: none;width: 35px;margin-top: -20px;">
    <svg fill="#0042aa" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 45.402 45.402" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141 c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27 c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435 c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z"></path> </g> </g></svg>
    </button>

    </div>
            <div class="form-element" style="width:200%;">
<span class="q">Add options with csv</span>
<span>Upload file in csv, for template <a  target="_blank" download href="csv upload template.csv" >click here</a></span>
<input  type="file" accept=".csv" onclick="optionsupload(this)"/>
<input type="hidden" value=""/>
</div>
    </div>
    `;
    var qsection =  button.parentElement.parentElement.parentElement.innerHTML;
    var newsection = qsection + newitem; 
    button.parentElement.parentElement.parentElement.insertAdjacentHTML("afterend",newitem) 
        }
      }
      else if(button.value =="File Upload"){
        if(button.parentElement.parentElement.parentElement.nextElementSibling.className!=="question-support"){
          button.parentElement.parentElement.parentElement.nextElementSibling.remove();
          var newitem = 
`
<div class="question-support">
  <span>Select the files to support</span>
  <div class="form-element radio-buttons" style="width: 47%;margin-top: 10px;display: flex;flex-direction: row;">
    <input type="hidden" >
    <label for="PDF">
<input
onchange="checkboxvalue(this)"
type="checkbox"
value=".PDF,.pdf"
/>

</label>
<span>PDF</span>
<label for="JPG">
<input
onchange="checkboxvalue(this)"
type="checkbox"
value=".JPG,.jpg,.JPEG,.jpeg"
/>

</label>
<span>JPG</span>
<label for="PNG">
<input
onchange="checkboxvalue(this)"
type="checkbox" 
value=".PNG,.png"
/>

</label>
<span>PNG</span>
<label for="PPT">
<input
onchange="checkboxvalue(this)"
type="checkbox" 
value=".ppt,.pptx"
/>

</label>
<span>PPT</span>
<label for="Doc">
<input
onchange="checkboxvalue(this)"
type="checkbox" 
value=".doc,.docx"
/>

</label>
<span>Doc</span>
    </div>
  </div>
    `;
    var qsection =  button.parentElement.parentElement.parentElement.innerHTML;
    var newsection = qsection + newitem; 
    button.parentElement.parentElement.parentElement.insertAdjacentHTML("afterend",newitem) 
        }
      }
      console.log(button.parentElement.parentElement.parentElement.nextElementSibling.className)
    }
    else if(button.value =="Checkbox"){
    console.log(button.value)
    button.parentElement.parentElement.nextElementSibling.children[0].style.display="none";
    button.parentElement.parentElement.parentElement.nextElementSibling.remove();
  }
    else{
   
   button.parentElement.parentElement.parentElement.nextElementSibling.remove();
 }
  }

  

}
var jhout =  sessionStorage.getItem("backuphtml");
var hout = JSON.parse(jhout);
 console.log(hout)
 if(jhout!==null){
 createhtmlmfromarray(hout)
 }
 function createhtmlmfromarray(html){
  console.log(html)
  
  document.getElementById("Form Name").value = html[0];
  document.getElementById("Form Description").innerHTML = html[1];
  document.getElementById("Single Response Field").value = html[2];

  if(html[2]!==""){
    document.getElementById("Single Response Field Check").checked=true;
  }
  en_span(document.getElementById("Form Description"))
  for (var i=4;i<html.length;i++){
    addquestion();
}
      var formDataString0 = document.getElementsByName("Question");
        var formDataString1 = document.getElementsByName("Question Type");
        var formDataString2 = document.getElementsByName("Question Description");
        var formDataString3 = document.getElementsByName("Question Required");
  for (var j=0;j<formDataString0.length;j++){
    console.log(html[j+3])
  if (html[j+3][0]!==undefined){
    formDataString0[j].value = html[j+3][0];
  }
  if (html[j+3][2]!==undefined){
    formDataString2[j].innerHTML = html[j+3][2];
    en_span(formDataString2[j])
  }
    if(html[j+3][3]=="Required"){
      formDataString3[j].checked = true;
    }
  if (html[j+3][1]!==undefined){
    formDataString1[j].value = html[j+3][1];
    addqoptions(formDataString1[j]);
    if (html[j+3][1] =="Options"||html[j+3][1] =="Multiple Select"||html[j+3][1] =="Dropdown"){
      
    var btn = formDataString0[j].parentElement.parentElement.parentElement.parentElement.children[1].children[2].children[0];
    console.log(btn)
    var nooption = html[j+3][4].length;
    console.log(nooption)
   for (var r=1;r<nooption;r++){
addoption(btn);
}
var optionss= btn.parentElement.parentElement.children;
console.log(optionss)
for (var h=1;h<optionss.length-2;h++){
  if(h==1){
    optionss[h].children[0].children[0].children[0].value = html[j+3][4][h-1];
  } 
  else{
    optionss[h].children[0].children[0].value = html[j+3][4][h-1];
  }
}

}
else if (html[j+3][1]=="File Upload"){
  var btn = formDataString0[j].parentElement.parentElement.parentElement.parentElement.children[1].children[1].querySelectorAll(("input"));
  console.log(btn)
  console.log(html[j+3][4])
  for (var a=1;a<btn.length;a++){
    var supval = btn[a].value;
    var supvale = html[j+3][4];
    var superafter =supvale.replace(supval,"")
    var supcon = supvale.length!==superafter.length;
  if(supcon){
    btn[a].checked =true;
  }
  }
  formDataString0[j].className = html[j+3][5];
}
  }

    
  }
  var opt =  getresoptions();
  console.log(opt,html[2]);
  var optindex = opt.findIndex(x => x == html[2]);
  console.log(optindex);
  document.getElementById("Single Response Field").selectedIndex=optindex+1;
  singleres(document.getElementById("Single Response Field Check"));
  document.getElementById("Single Response Field").value = html[2];
  gethtmldata();
 }
  var fetchurl ="";
         var uname ;
         const keyvalues = window.location.search;
     const value = new URLSearchParams(keyvalues);
     var idvalue = value.get('ui');
     
  
 
     var uids = [
       "398",
       "756",
       "652",
       "235",
       "453",
      "648",
       "378",
       "345",
       "904",
       "413",
       "254",
       "890",
       "333",
       "333",
       "333",
       
   ];
   var uorps = [
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "B.Tech",
    "M.Tech",
    "M.Tech",
    "M.Tech",
    "M.Tech",
    "M.Tech",
     "M.Tech"
   ]
   var inames = [
   'Anandha Keerthy M',
   'Anindit Bizy Nair',
   'David Evander Jebson S',
   'Keerthika P',
   'Nitheesh R L',
   'Shivam Jha',
   'Srinithi C P',
   'Subbu Krishna Sharma GM',
   'Yuvashreekantham R',
   'R B Ramyaa',
   'Anjali S',
   'Mathangi G',
   'Srivigneswar S',
   'Sathishwaran S',
   'Sample'
   ]
   var photourls =[
 'https://npics.pages.dev/1.jpg',
'https://npics.pages.dev/2.jpg',
'https://npics.pages.dev/3.jpg',
'https://npics.pages.dev/4.jpg',
'https://npics.pages.dev/5.jpg',
'https://npics.pages.dev/6.jpg',
'https://npics.pages.dev/7.jpg',
'https://npics.pages.dev/8.jpg',
'https://npics.pages.dev/9.jpg',
'https://npics.pages.dev/10.jpg',
'https://npics.pages.dev/11.jpg',
'https://npics.pages.dev/12.jpg',
'https://npics.pages.dev/13.jpg',
'https://npics.pages.dev/14.jpg',
'https://npics.pages.dev/0.jpg'

 ]
   var iurls = [
'https://script.google.com/macros/s/AKfycbxzHeGu3z7ChHoOQf4Lw1qgvY1kUL8lAs0mQAmTkwYaELXnCVy6gUm3nmUNHfhh0EGsOQ/exec',
'https://script.google.com/macros/s/AKfycbw6wbhOcrcyoOFuRn8RPSgZxdLnFbROVG2C6gu033ep9l6kk8GRFg6fKJQVX-yvzaOyrA/exec',
'https://script.google.com/macros/s/AKfycby0bpezZTGSTIBGxkSa4LymvbBYP68ro7LJ_aeL-TpRwoUtgq7J9jGtlNrPrpSFtLdMPw/exec',
'https://script.google.com/macros/s/AKfycbyPmVOKmWhJLFSSrXJucIFWn4HLqE5R-YaFy7fUfgd65GvuodABle1vHoQyK-idGYlq/exec',
'https://script.google.com/macros/s/AKfycbxEp-AGZgECifFXwbKOWXrVlKItShDBaqlQy1nNGXElI6BR6SJVeHntpWOBvT4GvkJFOA/exec',
'https://script.google.com/macros/s/AKfycbwXeCVS5KRLG_-fivdhmhV3Gj8mRPEDkDnqXeSsJFglqDmSHOeEk5snIeq3ujxGrUM/exec',
'https://script.google.com/macros/s/AKfycbyJ1XeGgRqAjR44TB_hTjLEyCMA7XHhv5hASQdRp2LqnAYxcfUm3NmYeHTZP7MwJRea/exec',
'https://script.google.com/macros/s/AKfycbx6MTdLho6wKtsbAZYfTym8KS_3NdNTzhyQD29Ls8Ww9Bk1Nuw40-kF1KWSTAJY90d2/exec',
'https://script.google.com/macros/s/AKfycby_oUg1_sTnZF5kTyG70JaA0DN_fSwhmFfnqph-Wnc-EU1UuvRxDahY_acAlwt9udo/exec',
'https://script.google.com/macros/s/AKfycbzQNai3ZVI_FxloADEK1zaj1KfzIxi-916CK1GgdWVYSWYPsTOkvTqhDcaDWw1AMG6flg/exec',
'https://script.google.com/macros/s/AKfycbxj_gCuRgJZ-Yu5QJAd-wMlvNonVPXHQV-mnGjr4d5Hz-a0x47brR-9byzQT8eyZSRS/exec',
'https://script.google.com/macros/s/AKfycbyVtGzaKOxucJJkHbNPjPHQvRV-PirSwetae8B2He_zgh9TnbKvHKKAgIzXzOy03-cS/exec',
'https://script.google.com/macros/s/AKfycbyD2RB2ak-oFcJgzF6J_AyV7D3hk4sp6V7H835NbL22S0kxCFJt1A16HW059pBmJOMj/exec',
'https://script.google.com/macros/s/AKfycbzGzDbJnrdaAQswQY05tvv8WWG6I6gI9TKbq-HP0QF6-N-Ko2v78v97euY6erkOKw/exec',
'https://script.google.com/macros/s/AKfycbw2vmyE-I2iQHjOS3BQHdqaNBjHlPdJ9sIPwyQgH8pZMQO2gpilLcOIvKJG-N067LbG/exec'
   ]
   for (var i = 0; i < uids.length; i++) {
     uname = localStorage.getItem("loggedname");
     console.log(uname)
     if (uname == inames[i]){
       idvalue = uids[i];
   fetchurl = iurls[i];
   console.log(document.getElementById("profileimage"));
   sessionStorage.setItem("backprofilepic",photourls[i]);
   document.getElementById("profileimage").src = photourls[i];
   document.getElementById("profileimage1").src = photourls[i];
   console.log(document.getElementById("profileimage").src,photourls[i])

     }
   }
   console.log(uname)
   console.log(fetchurl)
   document.getElementById("mname").innerHTML = uname;
  if (uname==undefined){
     alert("You are not logged in. Please log in");
     window.location="../index.html";
   }
const  GetUniqueID = () =>{
const uniqueID = localStorage.getItem("Passkey-uniqueID");
if (uniqueID == undefined){
const newUniqueID = crypto.randomUUID();

return [newUniqueID, "New"];
}
else {
return uniqueID;
}
}
async function passkey(){
           var passdevuniid =GetUniqueID();
           console.log(passdevuniid);
if (passdevuniid[1] ==  "New"){
 document.getElementById("loader").style.display="block"; 
           document.getElementById("load").style.display="initial";
           document.getElementById("message").textContent="Registering PassKey....";
         
       var passkeysss ={};
var fetchurl = "https://passkey-5ev6.onrender.com";
       const { startRegistration, startAuthentication } = SimpleWebAuthnBrowser;
           const url = new URL(window.location)
           const username = localStorage.getItem("loggedname");
           var weburl = location.hostname;
           console.log(weburl)
           const response = await fetch(fetchurl+'/register-challenge', {
               method: 'POST',
               headers: {
                   'Content-Type': 'application/json'
               },
               body: JSON.stringify({ username, weburl })
           })

           const challengeResult = await response.json()
           const { options } = challengeResult // Server side challenge

           const authenticationResult = await startRegistration({optionsJSON: options})
           console.log(authenticationResult)

           var urlorigin= location.protocol+"//"+location.host;
           console.log(urlorigin)
           var create_passkey = await fetch(fetchurl+'/register-verify', {
               method: 'POST',
               headers: {
                   'Content-Type': 'application/json'
               },
               body: JSON.stringify({ username, cred: authenticationResult, challenge: options.challenge, devUniId:passdevuniid[0], weburl,urlorigin })
           })
           const create_passkeyResult = await create_passkey.json();
           console.log(create_passkeyResult.result)
           
           
passkeysss = create_passkeyResult.info;
console.log(create_passkeyResult.info);
if (create_passkeyResult.info.userVerified){
 localStorage.setItem("Passkey-uniqueID",passdevuniid[0]);
 document.getElementById("loader").style.display="none"; 
document.getElementById("message").textContent="PassKey Registered Successfully";
setTimeout(function () { 
 document.getElementById("load").style.display="none";
},2000);
}


}
else{
alert("PassKey is already created for this Device")
}
}
      
  function showpass(){
    var btn = document.getElementById("Password").type ;

    if (btn == "password"){
      document.getElementById("Password").type = "text";
      document.getElementById("pass-show").style.display="none";
      document.getElementById("pass-hide").style.display="initial";

    }
    else if(btn == "text"){
      document.getElementById("Password").type = "password";
      document.getElementById("pass-show").style.display="initial";
      document.getElementById("pass-hide").style.display="none";
    }
  }
  function showpasscon(){
    var btn = document.getElementById("conPassword").type ;

    if (btn == "password"){
      document.getElementById("conPassword").type = "text";
      document.getElementById("conpass-show").style.display="none";
      document.getElementById("conpass-hide").style.display="initial";

    }
    else if(btn == "text"){
      document.getElementById("conPassword").type = "password";
      document.getElementById("conpass-show").style.display="initial";
      document.getElementById("conpass-hide").style.display="none";
    }
  }
  function showpassset(){
    var btn = document.getElementById("setPassword").type ;

    if (btn == "password"){
      document.getElementById("setPassword").type = "text";
      document.getElementById("setpass-show").style.display="none";
      document.getElementById("setpass-hide").style.display="initial";

    }
    else if(btn == "text"){
      document.getElementById("setPassword").type = "password";
      document.getElementById("setpass-show").style.display="initial";
      document.getElementById("setpass-hide").style.display="none";
    }
  }
  var username ="";
function checklogdetails(realhash,checkhash){
  console.log("hgf")
if (realhash == checkhash){
  onuploadcomplete ()

  }
  else{
    alert("Wrong Password");
    document.getElementById("load").style.display="none";
  }

}
function onuploadcomplete (){
document.getElementById("loader").style.display="none"; 
document.getElementById("message").textContent="Verified Successful";
setTimeout(function () { 
  document.getElementById("load").style.display="none";
  document.getElementById("verify").style.display = "none";
  document.getElementById("set").style.display = "initial";
 },2000);
}
function getuserdetails(user,pass){
    var formDataString =user;
    console.log(formDataString)
    document.getElementById("loader").style.display="block"; 
            document.getElementById("load").style.display="initial";
            document.getElementById("message").textContent="Verifying....";
    fetch(
      "https://script.google.com/macros/s/AKfycbyuCALW9JhZeQlYswMHwYgJFPRCOsvF7r6GE7uuJJ9g8TdkNXz_Qdigy1sAmem7JnAXKA/exec",
      {
        redirect: "follow",
        method: "POST",
        body: formDataString,
        headers: {
          "Content-Type": "text/plain;charset=utf-8",
        },
      }
    )

      .then(function (response) {

        // Check if the request was successful
        if (response) {
     
          return response; // Assuming your script returns JSON response
        } else {
          throw new Error("Failed to verify credentials");
        }
      })
      .then(async function (data) {
        const result1 = await data.json();
var userdetails = result1.data2;


console.log(userdetails)

if (userdetails[0]!=="Not Found"){
  var password = "Niftem@iac";
  if (pass == password){
    sessionStorage.setItem("setname",user);
window.location="set-pass.html";
  }
  else{
       var url ="https://passhash-yb0o.onrender.com";
async  function getdehash(){
    const res = await fetch(url+"/dehash",
        {
            method: "POST",
            headers:{
                "Content-Type": 'application/json'
            },
            body: JSON.stringify({
                password: pass,
                salt: userdetails[1]
        })
        }
    )
    .then(res=>res.json())
          
     .then(data=>console.log(data)&checklogdetails(userdetails[0],data.hash))
}
getdehash();
}
}
else if (userdetails[0]=="Not Found"){
  alert("User not found")
}
      })

      .catch(function (error) {
        // Handle errors, you can display an error message here
        console.error(error);
        document.getElementById("message").textContent =
          "An error occurred while verify credentials";
        document.getElementById("message").style.display = "block";
      });
    }
  
function verify(){
  var enusername = localStorage.getItem("loggedname");
  var enpassword = document.getElementById("Password").value;
  var Username = "iacadmin";
  username = enusername;


getuserdetails(enusername,enpassword);


}
</script>
<script>
  function onuploadcomplete1 (){

document.getElementById("loader").style.display="none"; 
document.getElementById("message").textContent="Password Set Successful";
setTimeout(function () { 
  document.getElementById("load").style.display="none";
  var setname = sessionStorage.getItem("setname");
  if (setname !== null){
  localStorage.setItem("loggedname", setname);
  }
  sessionStorage.removeItem("setname");
  window.location="index.html"
 },2000);
}
function getuserdetails1(user,pass,salt){
    var formDataString =user;
    console.log(formDataString)

    fetch(
      "https://script.google.com/macros/s/AKfycbyygOFv247irB10p9tBR4PAfFz0svS0GNfMtAIPnCHb5DeYO9d-m25a3BnK-D0rGAkRLA/exec",
      {
        redirect: "follow",
        method: "POST",
        body: JSON.stringify({
                password: pass,
                user: user,
                salt: salt
        }),
        headers: {
          "Content-Type": "text/plain;charset=utf-8",
        },
      }
    )

      .then(function (response) {

        // Check if the request was successful
        if (response) {
     
          return response; // Assuming your script returns JSON response
        } else {
          throw new Error("Failed to set password");
        }
      })
      .then(async function (data) {
        const result1 = await data.json();
var userdetails = result1.data2;


console.log(userdetails)
if (userdetails[0]!=="Not Found"){
  onuploadcomplete1 ()

}
else if (userdetails[0]=="Not Found"){
  alert("User not found")
  document.getElementById("load").style.display="none";
}
      })

      .catch(function (error) {
        // Handle errors, you can display an error message here
        console.error(error);
        document.getElementById("message").textContent =
          "An error occurred while set password";
        document.getElementById("message").style.display = "block";
      });
    }
  
function set(){
  document.getElementById("loader").style.display="block"; 
            document.getElementById("load").style.display="initial";
            document.getElementById("message").textContent="Setting Password....";
  function getusername(){
    var loggedname = localStorage.getItem("loggedname");
    if (loggedname !== null){
      return loggedname;
    }
    else{
      return sessionStorage.getItem("setname");
    }
  }
  var enusername = getusername();
  console.log(enusername)
  var enpassword = document.getElementById("setPassword").value;
  var enpassword1 = document.getElementById("conPassword").value;
  if (enpassword =="" ){
    alert("Enter the new password")
  }
  else   if (enpassword1 =="" ){
    alert("Enter the confirm password")
  }
  else if (enpassword == enpassword1){
  var Username = "iacadmin";
  var password = "Niftem@iac";

  async  function getdehash(){
    var url ="https://passhash-yb0o.onrender.com";
    const res = await fetch(url+"/hash",
        {
            method: "POST",
            headers:{
                "Content-Type": 'application/json'
            },
            body: JSON.stringify({
                password: enpassword
        })
        }
    )
    .then(res=>res.json())
          
     .then(data=>console.log(data)&getuserdetails1(enusername,data.hash,data.salt))
}
getdehash();
;

  }
else{
  alert("New Password and Confirm Password is not same")
}
}
</script>

<script>
  function createshort(question,description,required){
var template =
`
  <div class="form-element" >
        <span class="q">`+question+` `+required[1]+`</span>
         <span>`+description+`</span>
   <input `+required[0]+` type="text" name="`+question+`"  placeholder="Enter the `+question+`"/>
    </div>
`;
return template;
  }
  function createlong(question,description,required){
var template =
`
  <div class="form-element" >
        <span class="q">`+question+` `+required[1]+`</span>
         <span>`+description+`</span>
  <textarea  `+required[0]+`  name="`+question+`"  placeholder="Enter the `+question+`"/></textarea>
   
    </div>
`;
return template;
  }
  function createtimedate(question,description,required){
var template =
`
  <div class="form-element" >
        <span class="q">`+question+` `+required[1]+`</span>
         <span>`+description+`</span>
   <input  `+required[0]+` type="datetime-local" name="`+question+`"  placeholder="Enter the `+question+`"/>
    </div>
`;
return template;
  }
  function createcheckbox(question,required){
var template =
`
<div class="form-element" >
  <label for="`+question+`">
<input
`+required[0]+`
name="`+question+`"
type="checkbox"
value="`+question+`"

/>
<span>`+question+` `+required[1]+`</span>
</label>
    </div>
`;
return template;
  }
  function createtime(question,description,required){
var template =
`
  <div class="form-element" >
        <span class="q">`+question+` `+required[1]+`</span>
         <span>`+description+`</span>
   <input  `+required[0]+` type="time" name="`+question+`"  placeholder="Enter the `+question+`"/>
    </div>
`;
return template;
  }
  function createdate(question,description,required){
var template =
`
  <div class="form-element" >
        <span class="q">`+question+` `+required[1]+`</span>
         <span>`+description+`</span>
   <input  `+required[0]+` type="date" name="`+question+`"  placeholder="Enter the `+question+`"/>
    </div>
`;
return template;
  }
  function createfileupload(question,description,questionsupport,required,folder){
    var  filesupports = "";
    if(questionsupport.parentElement.parentElement.parentElement.parentElement.children[1].children[1].children[0].value!==""){
    filesupports = 'accept="'+ questionsupport.parentElement.parentElement.parentElement.parentElement.children[1].children[1].children[0].value+'"';
    }
var template =
`
<div class="form-element">
<span class="q">`+question+` `+required[1]+`</span>
<span>`+description+`</span>
<input `+required[0]+` type="file" `+filesupports+` onclick="formfileupload(this)"/>
<input type="hidden" name="`+question+` D.link" class="`+folder+`" value=""/>
</div>
`;
return template;
  }
  function createoptions(question,description,questionoptions,required){
    console.log(questionoptions.parentElement.parentElement.parentElement.nextElementSibling.getElementsByClassName("Question-Option"))
    var optionsq =  questionoptions.parentElement.parentElement.parentElement.nextElementSibling.getElementsByClassName("Question-Option");
var optionsadd ="";
    for(var i=0;i<optionsq.length;i++){
  var optionname = optionsq[i].value;
if(i==0){
   var optiontemp =`
<label for="`+optionname+`">
<input
 `+required[0]+` 
type="radio"
name="`+question+`"
class="`+question+`"

id="`+optionname+`"
value="`+optionname+`"

/>
<span>`+optionname+`</span>
</label>
`;}
else {
   var optiontemp =`
<label for="`+optionname+`">
<input

type="radio"
name="`+question+`"
class="`+question+`"

id="`+optionname+`"
value="`+optionname+`"

/>
<span>`+optionname+`</span>
</label>
`;}
optionsadd += optiontemp;
}
    var template =
`
<div class="form-element radio-buttons">
<span class="q">`+question+` `+required[1]+`</span>
<span>`+description+`</span>
`+optionsadd+`
</div>
`;
return template;
  }
  function createdropdown(question,description,questionoptions,required){
    console.log(questionoptions.parentElement.parentElement.parentElement.nextElementSibling.getElementsByClassName("Question-Option"))
    var optionsq =  questionoptions.parentElement.parentElement.parentElement.nextElementSibling.getElementsByClassName("Question-Option");
var optionsadd ="";
    for(var i=0;i<optionsq.length;i++){
  var optionname = optionsq[i].value;

   var optiontemp =`
<option value='`+optionname+`'>`+optionname+`</option>
`;
optionsadd += optiontemp;
}
    var template =
`
<div class="form-element radio-buttons">
<span class="q">`+question+` `+required[1]+`</span>
<span>`+description+`</span>
<select name="`+question+`"  `+required[0]+`  placeholder="Select `+question+`">
  <option value="">Select `+question+`</option>
`+optionsadd+`
</select>
</div>
`;
return template;
  }
  function createmultipleoptions(question,description,questionoptions,required){
    console.log(questionoptions.parentElement.parentElement.parentElement.nextElementSibling.getElementsByClassName("Question-Option"))
    var optionsq =  questionoptions.parentElement.parentElement.parentElement.nextElementSibling.getElementsByClassName("Question-Option");
var optionsadd ="";
    for(var i=0;i<optionsq.length;i++){
  var optionname = optionsq[i].value;
if(i==0) {
var optiontemp =`
<label for="`+optionname+`">
<input
 `+required[0]+` 
onchange="checkboxvalue(this)"
type="checkbox"
id="`+optionname+`"
value="`+optionname+`"

/>
<span>`+optionname+`</span>
</label>
`;}
else {
var optiontemp =`
<label for="`+optionname+`">
<input
onchange="checkboxvalue(this)"
type="checkbox"
id="`+optionname+`"
value="`+optionname+`"

/>
<span>`+optionname+`</span>
</label>
`;}

optionsadd += optiontemp;
}
    var template =
`
<div class="form-element radio-buttons">
<span class="q">`+question+` `+required[1]+`</span>
<span>`+description+`</span>
`+optionsadd+`
<input type="hidden" name="`+question+`">
</div>
`;
return template;
  }
  </script>
<script>

  let form = document.querySelector("form");
form.addEventListener('submit',()=>{ {
  document.getElementById("load").style.display="initial";
  document.getElementById("loader").style.display="block"; 
  document.getElementById("bt").style.display="none";
}})
  
document.getElementById("form").addEventListener("submit", function (e) {
        e.preventDefault(); // Prevent the default form submission
        document.getElementById("message").textContent = "Creating Form....";
        document.getElementById("message").style.display = "block";
        document.getElementById("bt").disabled = true;
        var formname = document.getElementById("Form Name").value;
var formdetailstring = formname;
console.log(formdetailstring)

        // Send a POST request to your Google Apps Script
        fetch(
          "https://script.google.com/macros/s/AKfycbwFuGSlzULICJ63jYRTrBO7ISOFhgXdk3_JJAx7SIxxtMUr0tA2CQKgCKjurv-l1YhC/exec",
          {
            redirect: "follow",
            method: "POST",
            body: formdetailstring,
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          }
        )

          .then(function (response) {

            // Check if the request was successful
            if (response) {
         
              return response; // Assuming your script returns JSON response
            } else {
              throw new Error("Failed to create the form.");
            }
          })
          .then(async function (data) {
            const result1 = await data.json();
            console.log(result1.data2);
            if (result1.data2 !== "reject"){
            // Display a success message
         
        createhtml(result1.data2);
            
      }
            else if (result1.data2 == "reject"){
              alert("Form name already used");
              document.getElementById("load").style.display="none";
              document.getElementById("bt").disabled = false;
              document.getElementById("bt").style.display="initial";
            }
          })

          .catch(function (error) {
            // Handle errors, you can display an error message here
            console.error(error);
            document.getElementById("message").textContent =
              "An error occurred while creating the form.";
            document.getElementById("message").style.display = "block";
          });
      });



      function refreshwin(){
        console.log("ok")
        window.location = window.location.href;
      }
async function createfolders(foldername,formfolder){
  var folderstring =foldername+"/fol/"+formfolder;
  var folderid = "";
  console.log(folderstring)
  await fetch(
          "https://script.google.com/macros/s/AKfycbytAObPgaWJVy2dAtalu1VVjU4V54KPIUJJTwbPECncz6wFJoBbzUCo8R53e31rQOSk/exec",
          {
            redirect: "follow",
            method: "POST",
            body: folderstring,
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          }
        )

          .then(function (response) {

            // Check if the request was successful
            if (response) {
         
              return response; // Assuming your script returns JSON response
            } else {
              throw new Error("Failed to create the form.");
            }
          })
          .then(async function (data) {
            const result1 = await data.json();
            console.log(result1.data2);
    
  folderid = result1.data2;

          })
          return folderid;

      
}
async function createhtml(formfolder){
crestatus ="Creating";
        
        var formDataString0 = document.getElementsByName("Question");
        var formDataString1 = document.getElementsByName("Question Type");
        var formDataString2 = document.getElementsByName("Question Description");
        var formDataString3 = document.getElementsByName("Question Required");
        
        console.log(formDataString0)
console.log(formDataString1)
console.log(formDataString2)
console.log(formDataString3)
      var htmlout ="";
      var htmlheads ="";
      var folderids ="";
        for(var h=0;h<formDataString0.length;h++){
          htmlheads += "=quheadss="+formDataString0[h].value;
          if (formDataString1[h].value=="Short Answer"){
            if(formDataString3[h].checked){
              var required =["required","*"];
            }
            else{
              var required =["",""];
            }
htmlout +=  createshort(formDataString0[h].value,formDataString2[h].innerHTML,required);
          }
          else if (formDataString1[h].value=="Long Answer"){
            if(formDataString3[h].checked){
              var required =["required","*"];
            }
            else{
              var required =["",""];
            }
htmlout +=  createlong(formDataString0[h].value,formDataString2[h].innerHTML,required);
          }
          else if (formDataString1[h].value=="Options"){
            if(formDataString3[h].checked){
              var required =["required","*"];
            }
            else{
              var required =["",""];
            }
htmlout +=  createoptions(formDataString0[h].value,formDataString2[h].innerHTML,formDataString0[h],required);
          }
          else if (formDataString1[h].value=="Dropdown"){
            if(formDataString3[h].checked){
              var required =["required","*"];
            }
            else{
              var required =["",""];
            }
htmlout +=  createdropdown(formDataString0[h].value,formDataString2[h].innerHTML,formDataString0[h],required);
          }
          else if (formDataString1[h].value=="Multiple Select"){
            if(formDataString3[h].checked){
              var required =["required","*"];
            }
            else{
              var required =["",""];
            }
htmlout +=  createmultipleoptions(formDataString0[h].value,formDataString2[h].innerHTML,formDataString0[h],required);
          }
          else if (formDataString1[h].value=="Time"){
            if(formDataString3[h].checked){
              var required =["required","*"];
            }
            else{
              var required =["",""];
            }
htmlout +=  createtime(formDataString0[h].value,formDataString2[h].innerHTML,required);
          }
          else if (formDataString1[h].value=="Date"){
            if(formDataString3[h].checked){
              var required =["required","*"];
            }
            else{
              var required =["",""];
            }
htmlout +=  createdate(formDataString0[h].value,formDataString2[h].innerHTML,required);
          }
          else if (formDataString1[h].value=="Time and Date"){
            if(formDataString3[h].checked){
              var required =["required","*"];
            }
            else{
              var required =["",""];
            }
htmlout +=  createtimedate(formDataString0[h].value,formDataString2[h].innerHTML,required);
          }
          else if (formDataString1[h].value=="Checkbox"){
            if(formDataString3[h].checked){
              var required =["required","*"];
            }
            else{
              var required =["",""];
            }
htmlout += createcheckbox(formDataString0[h].value,required);
          }
          else if (formDataString1[h].value=="File Upload"){
         console.log(formDataString0[h].parentElement.parentElement.parentElement.parentElement.children[1].children[1].children[0].value)   
           if(formDataString3[h].checked){
              var required =["required","*"];
            }
            else{
              var required =["",""];
            }
   var folder = await createfolders(formDataString0[h].value,formfolder)  
   console.log(folder)
   formDataString0[h].className = folder;
   folderids += "=qufolidss="+folder;
htmlout += createfileupload(formDataString0[h].value,formDataString2[h].innerHTML,formDataString0[h],required,folder);
          }
        }
   
console.log(htmlout)
var loggedname = localStorage.getItem("loggedname");
console.log(loggedname)
var formname = document.getElementById("Form Name").value;
var formdescrip = document.getElementById("Form Description").innerHTML;
var singleresponse = document.getElementById("Single Response Field").value;
var bulidupdetail = await gethtmldata();
var bulidupdetails = JSON.stringify(bulidupdetail);
console.log(formname+"=sheetid="+loggedname+"=sheetid="+"Created"+"=sheetid="+formdescrip+"=sheetid="+htmlout+"=sheetid="+htmlheads+"=sheetid="+formfolder+"=sheetid="+folderids+"=sheetid="+bulidupdetails+"=sheetid="+singleresponse)
        // Send a POST request to your Google Apps Script
        fetch(
          "https://script.google.com/macros/s/AKfycbyz_KDA1Kx1srwHeMXXl-UPTS_M0jdaoxh9NXEp8CiXp4qZC-_yGuOzcPjA9M6I99mI/exec",
          {
            redirect: "follow",
            method: "POST",
            body: formname+"=sheetid="+loggedname+"=sheetid="+"Created"+"=sheetid="+formdescrip+"=sheetid="+htmlout+"=sheetid="+htmlheads+"=sheetid="+formfolder+"=sheetid="+folderids+"=sheetid="+bulidupdetails+"=sheetid="+singleresponse,
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          }
        )

          .then(function (response) {

            // Check if the request was successful
            if (response) {
         
              return response; // Assuming your script returns JSON response
            } else {
              throw new Error("Failed to create the form.");
            }
          })
          .then(async function (data) {
            const result1 = await data.json();
            console.log(result1.data2);
            if (result1.data2 !== "Not Found"){
            // Display a success message
            sessionStorage.setItem("formlink",result1.data2)
            document.getElementById("bt").disabled = false;
            document.getElementById("form").reset();
        
            setTimeout(function () {
              document.getElementById("message").textContent = "";
              document.getElementById("message").style.display = "none";
              document.getElementById("placeform").style.display = "none";
              document.getElementById("msg").style.display = "flex";
          
              var link = "https://pcniftemt.pages.dev/preview-form/?form="+formname
              document.getElementById("finallink").innerHTML=' <a style=" color:blue;background:none;" href="'+link+'"target="_blank">'+"See Preview"+"</a><br>Form is created.To make live, go to Old Forms and make active";
              sessionStorage.removeItem("backuphtml");
             
              setTimeout(function () {
             window.location = "past-forms.html"
              }, 5000);
            }, 2600);}
            else if (result1.data2 == "Not Found"){
              alert("Form not created");
              document.getElementById("load").style.display="none";
            }
          })

          .catch(function (error) {
            // Handle errors, you can display an error message here
            console.error(error);
            document.getElementById("message").textContent =
              "An error occurred while creating the form.";
            document.getElementById("message").style.display = "block";
          });
      }


</script>
<script>
  function checkboxvalue(button){
    var value ="";
    var checks = button.parentElement.parentElement.children;
    console.log(checks)
    for(var i= 1; i<checks.length-1;i++){
      if (i % 2 != 0) {
      if(checks[i].children[0].checked==false&&checks[i].children[0].required){
        for(var f= 2; f<checks.length-1;f++){
        if(checks[f].children[0].checked){
        checks[i].children[0].required=false;
        checks[f].children[0].required=true;
        }
      }
      }
      
      if(checks[i].children[0].checked){
        if (value ==""){
     
          if(checks[i].children[0].value == "Other"&&button.type=="checkbox"){
       
            if(checks[i].children[4].type=="hidden"){
              console.log(checks[i].children[0].value)
              checks[i].children[4].type="text";
              checks[i].children[4].required = true;
            }

        }
        else if (checks[i].children[0].value !== "Other"){
          value += checks[i].children[0].value;
        }
    
        if( checks[i].children.length==5){
        if(checks[i].children[4].type=="text"&&checks[i].children[4].value!==""){
          value +=checks[i].children[4].value;
          checks[i].children[0].checked = true
        }
      }
        }
        else{
     
          if(checks[i].children[0].value == "Other"&&button.type=="checkbox"){
 
            if(checks[i].children[4].type=="hidden"){
              console.log(checks[i].children[0].value)
              checks[i].children[4].type="text";
              checks[i].children[4].required = true;
            }

         
        }
        else if (checks[i].children[0].value !== "Other"){
          value += ","+checks[i].children[0].value;
        }
 
        if( checks[i].children.length==5){
        if(checks[i].children[4].type=="text"&&checks[i].children[4].value!==""){
          value += ","+checks[i].children[4].value;
          checks[i].children[0].checked = true
        }
        }
      }

      }
      else if(checks[i].children[0].value == "Other"&&button.type=="checkbox"){
        
        checks[i].children[4].type="hidden";
        checks[i].children[4].value="";
      }
    }
  }
    console.log( checks[0])
    console.log(checks[0].value)
    checks[0].value = value
    console.log(checks[0].value)
  }
  </script>
  <script>
    async function getoptionvalues(execelurl){
  var folderstring =execelurl;
  var folderid = "";
  console.log(folderstring)
  document.getElementById("message").textContent="Getting Options....";
  await fetch(
          "https://script.google.com/macros/s/AKfycbxTyxAAtSh11HCT8sdy8gq6cAZwFaBJLckSbuWgWJA6JYkhJf4GSag-YZTyaVEzT1CZbw/exec",
          {
            redirect: "follow",
            method: "POST",
            body: folderstring,
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          }
        )

          .then(function (response) {

            // Check if the request was successful
            if (response) {
         
              return response; // Assuming your script returns JSON response
            } else {
              throw new Error("Failed to create the form.");
            }
          })
          .then(async function (data) {
            const result1 = await data.json();
            console.log(result1.data2);
    
  folderid = result1.data2;
  console.log(folderid)

          })
          return folderid;

      
}
    function optionsupload(button){
    let file1 = button;

    let fileurl1 = button.parentElement.children[3];
    var fol = fileurl1.className;
    file1.addEventListener('change',()=>{
    let fr = new FileReader();
    console.log(file1.value)
    var rawformats = file1.accept;
    console.log(rawformats)
var formats = rawformats.split(",");
console.log(formats)
var supformat ="";
for(var i=0;i<formats.length;i++){
  if(i==formats.length-1){
    supformat+=`file1.value.includes("`+formats[i]+`")`;
  }
  else{
    supformat+=`file1.value.includes("`+formats[i]+`")||`;
  }
}
console.log(supformat)
    if (supformat){
            document.getElementById("loader").style.display="block"; 
            document.getElementById("load").style.display="initial";
            document.getElementById("message").textContent="Uploading....";
            fr.addEventListener('loadend',()=>{
                let res = fr.result;
                let v = fileurl1.value.replace("/"+fol,"");
                let folder = "15GgsPpNztp41g7Sw7s7LOT0vhnYnViei";
        
                let spt = res.split("base64,")[1];
                let obj = {
                    base64:spt,
                    type:file1.files[0].type,
                    name:file1.files[0].name,
                    folder,
                    v
        
                }
                fetch("https://script.google.com/macros/s/AKfycbzjsZZ7VB5r1_XZUhWvkyDUDIvQM7qVQYu7gtZhChTMhiAyjfXGuHAQg21flXWsg-IOSg/exec",{
                    method:"POST",
                    body:JSON.stringify(obj)
                })
                .then(r=>r.text())
          
                
                .then(data=>onoptionuploadcomplete (data,button))
                .then(console.log(v) )
            })
            fr.readAsDataURL(file1.files[0])
                 
    }
    else{
        alert("Upload the file in correct format");
        button.value="";
    }
    }
) 

}

async function onoptionuploadcomplete (data,button){
  console.log(data)
var options = await getoptionvalues(data);
console.log(options)

for (var i=0;i<options.length;i++){
  console.log(i)
  addoptionexcel(options[i],button)
}
document.getElementById("loader").style.display="none"; 
    document.getElementById("message").textContent="Options Added Successfuly";
    setTimeout(function () { document.getElementById("load").style.display="none"; },2000);
}
function addoptionexcel(value,button){
var newitem = 
`
<div class="question-select">
  <div class="form-element">
    <input type="text" class="Question-Option" placeholder="`+value+`"/>
    </div>
    <button onclick="removeoption(this)" type="button" style="background: none;width: 32px;margin-top: -30px;">
      <svg fill="#0042aa" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 41.756 41.756" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M27.948,20.878L40.291,8.536c1.953-1.953,1.953-5.119,0-7.071c-1.951-1.952-5.119-1.952-7.07,0L20.878,13.809L8.535,1.465 c-1.951-1.952-5.119-1.952-7.07,0c-1.953,1.953-1.953,5.119,0,7.071l12.342,12.342L1.465,33.22c-1.953,1.953-1.953,5.119,0,7.071 C2.44,41.268,3.721,41.755,5,41.755c1.278,0,2.56-0.487,3.535-1.464l12.343-12.342l12.343,12.343 c0.976,0.977,2.256,1.464,3.535,1.464s2.56-0.487,3.535-1.464c1.953-1.953,1.953-5.119,0-7.071L27.948,20.878z"></path> </g> </g></svg>
    </button>
  </div>
`;
 var lastoption=button.parentElement.parentElement.children;
button.parentElement.parentElement.children[lastoption.length-3].insertAdjacentHTML("afterend",newitem);
console.log(lastoption[lastoption.length-3].children[0].children[0])
lastoption[lastoption.length-3].children[0].children[0].value=value
  }
</script>
<script>
    function updatelogstatus(status){
      var updatestring = localStorage.getItem("loggedname")+"/"+status;
 
           
       fetch(
    
    "https://script.google.com/macros/s/AKfycbxEoNGPxEXxwtSXqRvPhgGK_btTmbVO4Tq6ZW002Q7Olap6cyoi5hmNAwYTS3OfLJCLug/exec",
    {
      redirect: "follow",
      method: "POST",
      body: updatestring,
      headers: {
        "Content-Type": "text/plain;charset=utf-8",
      },
    }
   )
   
    .then(function (response) {
   
      // Check if the request was successful
      if (response) {
   
        return response; // Assuming your script returns JSON response
      } else {
        throw new Error("Failed to fetch.");
      }
    })
    .then(async function (data) {
   const result1 = await data.json();
   
   var r = result1.data2;
  
   
   })
   
   .catch(function (error) {
   // Handle errors, you can display an error message here
   console.error(error);

   });
   }


setTimeout(() => {

updatelogstatus("Online");

}, 2000)
window.addEventListener("blur", () => {
  updatelogstatus("Offline");   
  });
  window.addEventListener("focus", () => {
  updatelogstatus("Online");   
  });
//window.unblur = colse();
const beforeUnloadHandler = (event) => {  
  updatelogstatus("Offline");  
};
window.addEventListener("beforeunload", beforeUnloadHandler);


   </script>
<script src="scriptplaceform.js  "></script>
<script src="scriptform.js"></script>
<script src="drag.js"></script>
</html>